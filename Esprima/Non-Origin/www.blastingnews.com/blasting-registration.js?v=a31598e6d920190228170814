$(document).ready(function () {

  //form di registrazione
  $(document).on("focus", "#contact_form input, #contact_form-follow input", function () {
    $(this).nextAll("div.error:first:visible").hide();
  });
  
  $(document).on("focus", "#contact_form input, #contact_form-poll input", function () {
    $(this).nextAll("div.error:first:visible").hide();
  });


  $(document).on("blur", "#contact_nome", function () {
    validate_name();
  });

  $(document).on("blur", '#contact_nome-follow', function () {
    validate_name_follow();
  });
  
  $(document).on("blur", '#contact_nome-poll', function () {
    validate_name_poll();
  });

  $(document).on("blur", "#contact_cognome", function () {
    if (validate_surname()) {
      fCheckSignature($("#contact_slug").val());
    }
  });

  $(document).on("blur", '#contact_cognome-follow', function () {
    if (validate_surname_follow()) {
      fCheckSignature_follow($("#contact_slug-follow").val());
    }
  });
  
  $(document).on("blur", '#contact_cognome-poll', function () {
    if (validate_surname_poll()) {
      fCheckSignature_poll($("#contact_slug-poll").val());
    }
  });

  $(document).on("blur", "#contact_email", function () {
    validate_email();
  });

  $(document).on("blur", '#contact_email-follow', function () {
    validate_email_follow();
  });

  $(document).on("blur", '#contact_email-poll', function () {
    validate_email_poll();
  });

  $(document).on("blur", "#contact_password", function () {
    validate_password();
  });

  $(document).on("blur", '#contact_password-follow', function () {
    validate_password_follow();
  });
  
  $(document).on("blur", '#contact_password-poll', function () {
    validate_password_poll();
  });

  $(document).on("blur", "#contact_signature", function () {
    validate_signature();
  });

  $(document).on("blur", "#contact_signature-follow", function () {
    validate_signature_follow();
  });
  
  $(document).on("blur", "#contact_signature-poll", function () {
    validate_signature_poll();
  });

  $(document).on("change", "#contact_nome", function () {
    if ($("#contact_nome").val() != "" && $("#contact_cognome").val() != "") {
      $("#contact_signature").val($("#contact_nome").val() + " " + $("#contact_cognome").val());
      var slug_path = makeAlias($("#contact_signature").val());
      $("#contact_slug").val(slug_path);

    } else {
      $("#contact_signature").val("");
      $("#contact_slug").val("");
    }
  });

  $(document).on("change", "#contact_nome-follow", function () {
    if ($("#contact_nome-follow").val() != "" && $("#contact_cognome-follow").val() != "") {
      $("#contact_signature-follow").val($("#contact_nome-follow").val() + " " + $("#contact_cognome-follow").val());
      var slug_path = makeAlias($("#contact_signature-follow").val());
      $("#contact_slug-follow").val(slug_path);

    } else {
      $("#contact_signature-follow").val("");
      $("#contact_slug-follow").val("");
    }
  });
  
  $(document).on("change", "#contact_nome-poll", function () {
    if ($("#contact_nome-poll").val() != "" && $("#contact_cognome-poll").val() != "") {
      $("#contact_signature-follow").val($("#contact_nome-poll").val() + " " + $("#contact_cognome-poll").val());
      var slug_path = makeAlias($("#contact_signature-poll").val());
      $("#contact_slug-poll").val(slug_path);

    } else {
      $("#contact_signature-poll").val("");
      $("#contact_slug-poll").val("");
    }
  });
  

  $(document).on("change", "#contact_cognome", function () {
    if ($("#contact_nome").val() != "" && $("#contact_cognome").val() != "") {
      $("#contact_signature").val($("#contact_nome").val() + " " + $("#contact_cognome").val());
      var slug_path = makeAlias($("#contact_signature").val());
      $("#contact_slug").val(slug_path);
    } else {
      $("#contact_signature").val("");
      $("#contact_slug").val("");
    }
  });

  $(document).on("change", "#contact_cognome-follow", function () {
    if ($("#contact_nome-follow").val() != "" && $("#contact_cognome-follow").val() != "") {
      $("#contact_signature-follow").val($("#contact_nome-follow").val() + " " + $("#contact_cognome-follow").val());
      var slug_path = makeAlias($("#contact_signature-follow").val());
      $("#contact_slug-follow").val(slug_path);
    } else {
      $("#contact_signature-follow").val("");
      $("#contact_slug-follow").val("");
    }
  });
  
   $(document).on("change", "#contact_cognome-poll", function () {
    if ($("#contact_nome-poll").val() != "" && $("#contact_cognome-poll").val() != "") {
      $("#contact_signature-poll").val($("#contact_nome-poll").val() + " " + $("#contact_cognome-poll").val());
      var slug_path = makeAlias($("#contact_signature-poll").val());
      $("#contact_slug-poll").val(slug_path);
    } else {
      $("#contact_signature-poll").val("");
      $("#contact_slug-poll").val("");
    }
  });

  $(document).on("change", "#contact_signature", function () {
    var slug_path = makeAlias($("#contact_signature").val());
    $("#contact_slug").val(slug_path);
  });

  $(document).on("change", "#contact_signature-follow", function () {
    var slug_path = makeAlias($("#contact_signature-follow").val());
    $("#contact_slug-follow").val(slug_path);
  });
  
  $(document).on("change", "#contact_signature-poll", function () {
    var slug_path = makeAlias($("#contact_signature-poll").val());
    $("#contact_slug-poll").val(slug_path);
  });

  initPrivacy();
  initError();

  initPrivacy_follow();
  initError_follow();

  $(document).on("click", "#login-registration", function () {
    $(".error").hide();
    
    $('#form-register input, #form-register textarea').each(function(){
      $(this).val(jQuery.trim($(this).val()));
    });
    
    valid = validate_form();

    if (valid) {
      var serializedData = $("#form-register").serialize();
      
      $.ajax({
        url: '/app/regUser/',
        type: "POST",
        dataType: "json",
        data: serializedData,
        beforeSend: function () {
          $('#form-register').hide();
          $('.facebook-complete').hide();
          createLoader();
        },
        success: function (res) {
          $('#box_loader').remove();

          if (res.code == 200) {
            $('body').removeClass("fixed")
            $('#menu-mobile').hide();
            $('#menu-mobile').css("opacity", "0");
            $('#menu-mobile').css("z-index", "-1");
            $('#menu-mobile').css("left", "-95%");
            $('.footer').css("opacity", "1");

            if (res.message.location.length > 0) {
              document.location = res.message.location;
            } else {
              resetForm($('#form-register'));
              createSuccessMessage(message_9);
              email_conf_sent = true;
              return true;
            }
          } else {
            $('#box_loader').remove();
            $('#contact_form').show();
            showError("generic", res.message.error);
            return false;
          }
        },
        error: function () {
          $('#box_loader').remove();
          $('#contact_form').show();
          showError("generic", message_10);
          return false;
        }
      });
    }
    return false;
  });

  $(document).on("click", '#login-registration-follow', function () {
    $(".error").hide();
    var fb_noemail = false;
    if ($("#login-registration-follow").hasClass("facebooknoemailgiven")) {
      fb_noemail = true;
    }

    $('#form-register-follow input, #form-register-follow textarea').each(function(){
      $(this).val(jQuery.trim($(this).val()));
    });

    if(fb_noemail) { 
      valid = validate_form_facebook_no_email();
    } else {
      valid = validate_form_follow();
    }
    
    if (valid) {
      
      if(fb_noemail) {
        var serializedData = $("#form-register-fb-moemail").serialize();
      } else {
        var serializedData = $("#form-register-follow").serialize();
      }
      
      if (is_rating) {
        serializedData = serializedData + "&is_rating=true";
      }
      if(typeof directlive_attendee_temp_value !== "undefined" && directlive_attendee_temp_value != null) {
        var action = $(directlive_attendee_temp_value).data("action");
        serializedData = serializedData + "&partecipa=true&partecipa_value="+action+"&partecipa_obj="+nid;
      }

      if (fb_noemail) {
        serializedData = serializedData + "&noemailgiven=true";
        /*if(BlastingPoll) {
          BlastingPoll.togglePleaseWait();
          $('.register-poll').hide();
        }*/
      }

      var param_type = false;
      if(typeof type_flow !== "undefined" && type_flow !== false){
        param_type = type_flow;
        serializedData = serializedData + '&type_flow='+param_type;
        type_flow = false;
      }
      $.ajax({
        url: '/app/regUser/',
        type: "POST",
        dataType: "json",
        data: serializedData,
        beforeSend: function () {
          //$('#form-register').hide();
          $("#register-box-follow").html("");
          $('.facebook-complete').hide();
          createLoader_follow();
        },
        success: function (res) {
          $('#box-loader-follow').remove();

          if (res.code == 200) {
            if (res.message.location.length > 0) {
              document.location = res.message.location;
            } else {

              //if(typeof directlive_attendee_temp_value !== "undefined" && directlive_attendee_temp_value != null) {
              //  $('#btn-partecipa-group').hide();
              //}

              if (typeof BlastingArrate !== "undefined") {
                for(i in BlastingArrate){
                  BlastingArrate[i]._can_rate = true;
                  if(BlastingArrate[i]._temp_rate != null){
                    BlastingArrate[i].setAsync(false);
                    //BlastingArrate[i].setOpenModal(false);
                    BlastingArrate[i].rate();
                    break;
                  }
                }
              }

              resetForm($('#form-register-follow'));
              createSuccessMessage_follow(message_9);
              email_conf_sent = true;
              return true;
            }
          } else {
            $('#box-loader-follow').remove();
            $('#contact_form-follow').show();
            showError_follow("generic", res.message.error);
            return false;
          }
        },
        error: function () {
          $('#box-loader-follow').remove();
          $('#contact_form-follow').show();
          showError_follow("generic", message_10);
          return false;
        }
      });
    }
    return false;
  });
  
  $(document).on("click", '#login-registration-poll', function () {
    $(".error").hide();
    
    valid = validate_form_poll();
    
    if (valid) {
      var serializedData = $("#form-register-poll").serialize();
      
      BlastingPoll.togglePleaseWait();
      $('.register-poll').hide();
      
      $.ajax({
        url: '/app/regUser/',
        type: "POST",
        dataType: "json",
        data: serializedData,
        beforeSend: function () {
          //$('#form-register').hide();
          $("#register-box-poll").html("");
          $('.facebook-complete').hide();
          createLoader_follow();
        },
        success: function (res) {
          $('#box-loader-poll').remove();

          if (res.code == 200) {
            if (res.message.location.length > 0) {
              document.location = res.message.location;
            } else {

              resetForm($('#form-register-poll'));
              //createSuccessMessage_poll(message_9);
              BlastingPoll.updtaeVoteAfterLogin();
              email_conf_sent = true;
              return true;
            }
          } else {
            $('#box-loader-poll').remove();
            $('#contact_form-poll').show();
            showError_poll("generic", res.message.error);
            return false;
          }
        },
        error: function () {
          $('#box-loader-poll').remove();
          $('#contact_form-poll').show();
          showError_poll("generic", message_10);
          return false;
        }
      });
    }
    return false;
  });


  $('#login-registration-2').click(function () {
    $(".error").hide();
    valid = validate_form();
    if (valid) {
      var serializedData = $("#form-register").serialize();
      $.ajax({
        url: '/app/regUser/',
        type: "POST",
        dataType: "json",
        data: serializedData,
        beforeSend: function () {
          $('#form-register').hide();
          $('.facebook-complete').hide();

          var box_loader = $('<div id="box_loader">');
          var img = $('<img>');
          img.attr('width', '32');
          img.attr('height', '32');
          img.attr('src', cdn_resource+'/images/ajax-loader.gif');
          img.attr('style', 'margin: 70px 0 0 117px; float:left;');
          var span = $('<span>');
          span.attr('style', 'height: 32px; float: left; width: 150px; margin: 8px 0 0 60px;');
          span.text(message_11);
          box_loader.append(img);
          box_loader.append(span);
          $('#register-content-2').append(box_loader);

        },
        success: function (res) {
          $('#box_loader').remove();
          if (res.code == 200) {
            if (res.message.location.length > 0) {
              document.location = res.message.location;
            } else {
              resetForm($('#form-register'));
              var message = message_12;
              var box_loader = $('<div id="box_success">');
              var span = $('<span>');
              span.attr('style', ' height: 100%; font-size: 15px; width: 100%; margin: 35px 0px 0px 0px; padding: 20px; float: left;');
              span.html(message);
              box_loader.append(span);
              $('#register-content-2').append(box_loader);
              email_conf_sent = true;
              return true;
            }
          } else {
            $('#box_loader').remove();
            $('#contact_form').show();
            showError("generic", res.message.error);
            return false;
          }
        },
        error: function () {
          $('#box_loader').remove();
          $('#contact_form').show();
          showError("generic", message_10);
          return false;
        }
      });
    }
    return false;
  });

  //DA QUI CODICE AGGIUNTIVO PER LOGIN FOLLOW ------------------------------------

  $(document).click(function (event) {
    $('#register-box-follow .error').hide();
  });
  
  $(document).click(function (event) {
    $('#register-box-poll .error').hide();
  });

  $(document).on("click", "#login-your-mail-follow", function (event) {
    $('#login-your-mail-follow').hide();
    $('#form-register-follow').show();
    event.stopPropagation();
  });

  $(document).on("click", "#register-box-follow", function (event) {
    event.stopPropagation();
  });

  $(document).on("click", "#privacy-box-follow", function (event) {
    event.stopPropagation();
  });
  
  $(document).on("click", "#register-box-poll", function (event) {
    event.stopPropagation();
  });

  $(document).on("click", "#privacy-box-poll", function (event) {
    event.stopPropagation();
  });

  $(".ceck").click(function (event) {
    event.stopPropagation();
  });

  $(document).on("click", "#register-privacy-link-follow", function (e) {
    e.preventDefault();
    $("#register-box-follow").hide();
    $("#privacy-box-follow").fadeIn(5);
  });

  $(document).on("click", "#aPrivacyBack-follow", function (e) {
    e.preventDefault();
    $("#register-box-follow").fadeIn();
    $("#privacy-box-follow").hide();
  });
  
  $(document).on("click", "#register-privacy-link-poll", function (e) {
    e.preventDefault();
    $("#register-box-poll").hide();
    $("#privacy-box-poll").fadeIn(5);
  });

  $(document).on("click", "#aPrivacyBack-poll", function (e) {
    e.preventDefault();
    $("#register-box-poll").fadeIn();
    $("#privacy-box-poll").hide();
  });
  
//FINE CODICE AGGIUNTIVO PER LOGIN FOLLOW --------------------------------------
});

function getModalRegistration() {
  if ($("#form-register").length == 0) {//inietto il form di registrazione
    $.ajax({
      type: "POST",
      url: "/app/get_modal_registration/",
      success: function (html) {
        $("#register-content").html(html);
        initPrivacy();
        initError();
        $("#img-loader-registration").remove();
      },
      error: function (data) {
        $("#register").append("error");
      }
    });
  }
}


function validate_form() {
  var valid = true;

  if (!validate_name()) {
    valid = false;
    hidePrivacy();
  }

  if (!validate_surname()) {
    valid = false;
    hidePrivacy();
  }

  if (!validate_email()) {
    valid = false;
    hidePrivacy();
  }

  if (!validate_signature()) {
    valid = false;
    hidePrivacy();
  }

  if (!validate_password()) {
    valid = false;
    hidePrivacy();
  }

  if (!validatePrivacy()) {
    valid = false;
    hidePrivacy();
  }

  return valid;
}

function validate_form_follow() {
  var valid = true;

  if (!validate_name_follow()) {
    valid = false;
    hidePrivacy_follow();
  }

  if (!validate_surname_follow()) {
    valid = false;
    hidePrivacy_follow();
  }

  if (!validate_email_follow()) {
    valid = false;
    hidePrivacy_follow();
  }

  if (!validate_signature_follow()) {
    valid = false;
    hidePrivacy_follow();
  }

  if (!validate_password_follow()) {
    valid = false;
    hidePrivacy_follow();
  }

  if (!validatePrivacy_follow()) {
    valid = false;
    hidePrivacy_follow();
  }

  return valid;
}


function validate_form_facebook_no_email() {
  
  var valid = true;

  if (!validate_email_follow()) {
    valid = false;
    hidePrivacy_follow();
  }

  if (!validatePrivacy_follow()) {
    valid = false;
    hidePrivacy_follow();
  }

  return valid;
  
}



function validate_form_poll() {
  var valid = true;

  if (!validate_name_poll()) {
    valid = false;
    hidePrivacy_poll();
  }

  if (!validate_surname_poll()) {
    valid = false;
    hidePrivacy_poll();
  }

  if (!validate_email_poll()) {
    valid = false;
    hidePrivacy_poll();
  }

  if (!validate_signature_poll()) {
    valid = false;
    hidePrivacy_poll();
  }

  if (!validate_password_poll()) {
    valid = false;
    hidePrivacy_poll();
  }

  if (!validatePrivacy_poll()) {
    valid = false;
    hidePrivacy_poll();
  }

  return valid;
}


function validate_name() {
  if (!validate('contact_nome')) {
    showError('contact_nome', message_13);
    return false;
  } else if (fCheckDigits.test($("#contact_nome").val())) {
    $("#contact_nome").val("");
    showError("contact_nome", message_14);
    return false;
  } else {
    clearize('#contact_nome_error');
    return true;
  }
}

function validate_name_follow() {
  if (!validate('contact_nome-follow')) {
    showError_follow('contact_nome', message_13);
    return false;
  } else if (fCheckDigits.test($("#contact_nome-follow").val())) {
    $("#contact_nome-follow").val("");
    showError_follow("contact_nome", message_14);
    return false;
  } else {
    clearize('#contact_nome_error-follow');
    return true;
  }
}

function validate_name_poll() {
  if (!validate('contact_nome-poll')) {
    showError_poll('contact_nome', message_13);
    return false;
  } else if (fCheckDigits.test($("#contact_nome-poll").val())) {
    $("#contact_nome-poll").val("");
    showError_poll("contact_nome", message_14);
    return false;
  } else {
    clearize('#contact_nome_error-poll');
    return true;
  }
}

function validate_surname() {
  if (!validate('contact_cognome')) {
    showError('contact_cognome', message_15);
    return false;
  } else if (fCheckDigits.test($("#contact_cognome").val())) {
    $("#contact_cognome").val("");
    showError("contact_cognome", message_14);
    return false;
  } else {
    clearize('#contact_cognome_error');
    return true;
  }
}

function validate_surname_follow() {
  if (!validate('contact_cognome-follow')) {
    showError_follow('contact_cognome', message_15);
    return false;
  } else if (fCheckDigits.test($("#contact_cognome-follow").val())) {
    $("#contact_cognome-follow").val("");
    showError_follow("contact_cognome", "Numbers not allowed in this field");
    return false;
  } else {
    clearize('#contact_cognome_error-follow');
    return true;
  }
}

function validate_surname_poll() {
  if (!validate('contact_cognome-poll')) {
    showError_poll('contact_cognome', message_15);
    return false;
  } else if (fCheckDigits.test($("#contact_cognome-poll").val())) {
    $("#contact_cognome-poll").val("");
    showError_poll("contact_cognome", "Numbers not allowed in this field");
    return false;
  } else {
    clearize('#contact_cognome_error-poll');
    return true;
  }
}

function validate_password() {
  if (!validate('contact_password')) {
    showError('contact_password', message_16);
    return false;
  } else {
    clearize('#contact_password_error');
    return true;
  }
}

function validate_password_follow() {
  if (!validate('contact_password-follow')) {
    showError_follow('contact_password', message_16);
    return false;
  } else {
    clearize('#contact_password_error-follow');
    return true;
  }
}

function validate_password_poll() {
  if (!validate('contact_password-poll')) {
    showError_poll('contact_password', message_16);
    return false;
  } else {
    clearize('#contact_password_error-poll');
    return true;
  }
}

function validate_email() {
  var validate_em = true;

  if (!validate("contact_email")) {
    showError('contact_email', message_17);
    validate_em = false;
  } else if (!fCheckMail.test($("#contact_email").val())) {
    showError("contact_email", message_18);
    validate_em = false;
  } else if (!validateEmail()) {
    validate_em = false;
  } else {
    clearize('#contact_email_error');
  }
  return validate_em;
}

function validate_email_follow() {
  var validate_em = true;

  if (!validate("contact_email-follow")) {
    showError_follow('contact_email', message_17);
    validate_em = false;
  } else if (!fCheckMail.test($("#contact_email-follow").val())) {
    showError_follow("contact_email", message_18);
    validate_em = false;
  } else if (!validateEmail_follow()) {
    validate_em = false;
  } else {
    clearize('#contact_email_error-follow');
  }
  return validate_em;
}

function validate_email_poll() {
  var validate_em = true;

  if (!validate("contact_email-poll")) {
    showError_poll('contact_email', message_17);
    validate_em = false;
  } else if (!fCheckMail.test($("#contact_email-poll").val())) {
    showError_poll("contact_email", message_18);
    validate_em = false;
  } else if (!validateEmail_poll()) {
    validate_em = false;
  } else {
    clearize('#contact_email_error-poll');
  }
  return validate_em;
}



function validateEmail() {
  var email = $('#contact_email').val();
  var response = true;
  $.ajax({
    url: "/app/chkEmail/",
    type: "POST",
    data: {em: email},
    async: false,
    success: function (data) {
      if (data.code == 200) {
        response = true;
      } else {
        showError("contact_email", data.valore);
        response = false;
      }
    },
    error: function () {
      response = false;
    }
  });
  return response;

}

function validateEmail_follow() {
  var email = $('#contact_email-follow').val();
  var response = true;
  $.ajax({
    url: "/app/chkEmail/",
    type: "POST",
    data: {em: email},
    async: false,
    success: function (data) {
      if (data.code == 200) {
        response = true;
      } else {
        showError_follow("contact_email", data.valore);
        response = false;
      }
    },
    error: function () {
      response = false;
    }
  });
  return response;

}

function validateEmail_poll() {
  var email = $('#contact_email-poll').val();
  var response = true;
  $.ajax({
    url: "/app/chkEmail/",
    type: "POST",
    data: {em: email},
    async: false,
    success: function (data) {
      if (data.code == 200) {
        response = true;
      } else {
        showError_follow("contact_email", data.valore);
        response = false;
      }
    },
    error: function () {
      response = false;
    }
  });
  return response;

}



function validate_signature() {
  if ($("#contact_signature").val() == "") {
    showError("contact_signature", message_64);
    return false;
  } else if (!fCheckSignature($("#contact_signature").val())) {
    return false;
  } else {
    return true;
  }
}

function validate_signature_follow() {
  if ($("#contact_signature-follow").val() == "") {
    showError_follow("contact_signature", message_64);
    return false;
  } else if (!fCheckSignature_follow($("#contact_signature-follow").val())) {
    return false;
  } else {
    return true;
  }
}

function validate_signature_poll() {
  if ($("#contact_signature-poll").val() == "") {
    showError_poll("contact_signature", message_64);
    return false;
  } else if (!fCheckSignature_poll($("#contact_signature-poll").val())) {
    return false;
  } else {
    return true;
  }
}

function fCheckSignature(signature) {
  signature = makeAlias(signature);
  var response = false;
  if(signature.trim().length > 0) {
    response = true;
    $.ajax({
      type: 'POST',
      url: '/app/chkSign/',
      dataType: "json",
      cache: false,
      async: false,
      data: {
        q: signature
      },
      success: function (data) {
        if (data.risultato == "ok") {
          //$('#contact_signature').hide();
          clearize('#contact_signature_error');
          response = true;
        } else {
          showError("contact_signature", message_19);
          $('#nickname').show();
          response = false;
        }
      }
    });
  }
  return response;
}

function fCheckSignature_follow(signature) {
  signature = makeAlias(signature);
  var response = false;
  if(signature.trim().length > 0) {
    response = true;
    $.ajax({
      type: 'POST',
      url: '/app/chkSign/',
      dataType: "json",
      cache: false,
      async: false,
      data: {
        q: signature
      },
      success: function (data) {
        if (data.risultato == "ok") {
          //$('#contact_signature').hide();
          clearize('#contact_signature_error-follow');
          response = true;
        } else {
          showError_follow("contact_signature", message_19);
          $('#nickname-follow').show();
          response = false;
        }
      }
    });
  }
  return response;
}

function fCheckSignature_poll(signature) {
  signature = makeAlias(signature);
  var response = false;
  if(signature.trim().length > 0) {
    response = true;
    $.ajax({
      type: 'POST',
      url: '/app/chkSign/',
      dataType: "json",
      cache: false,
      async: false,
      data: {
        q: signature
      },
      success: function (data) {
        if (data.risultato == "ok") {
          //$('#contact_signature').hide();
          clearize('#contact_signature_error-poll');
          response = true;
        } else {
          showError_poll("contact_signature", message_19);
          $('#nickname-poll').show();
          response = false;
        }
      }
    });
  }
  return response;
}


var validatePrivacy = function () {
  valid = true;
  if ($("#contact_privacy_checkbox").is(":checked")) {
  } else if ($("#chkPrivacyCheck0").is(":checked") && $("#chkPrivacyCheck1").is(":checked")) {
  } else {
    $("#divStdPrivError").show();
    valid = false;
  }
  return valid;
}

var validatePrivacy_follow = function () {
  valid = true;
  if ($("#contact_privacy_checkbox-follow").is(":checked")) {
  } else if ($("#chkPrivacyCheck0-follow").is(":checked") && $("#chkPrivacyCheck1-follow").is(":checked")) {
  } else {
    $("#divStdPrivError-follow").show();
    valid = false;
  }
  return valid;
}

var validatePrivacy_poll = function () {
  valid = true;
  if ($("#contact_privacy_checkbox-poll").is(":checked")) {
  } else if ($("#chkPrivacyCheck0-poll").is(":checked") && $("#chkPrivacyCheck1_fake-poll").is(":checked")) {
  } else {
    $("#divStdPrivError-poll").show();
    valid = false;
  }
  return valid;
}


function initError() {
  $('.error').attr('style', 'display:none;');
}

function initError_follow() {
  $('.error').attr('style', 'display:none;');
}

function initError_poll() {
  $('.error').attr('style', 'display:none;');
}



function initPrivacy() {
  $(document).on("click", "#contact_privacy_link", function (e) {
    e.preventDefault();
    $("#tbn-head-register-head").hide();
    $("#divPrivacyDetails2").fadeIn(10);

    //var destination = $("#contact_form").offset();
    //$("html:not(:animated),body:not(:animated)").animate({
    //scrollTop: destination.top - 170
    //}, 500);

  });

  $(document).on("click", "#aPrivacyBack", function (e) {
    e.preventDefault();
    $("#tbn-head-register-head").fadeIn();
    $("#divPrivacyDetails2").hide();
  });

  $(document).on("click", "#chkPrivacyCheck1_fake", function (e) {
    if ($(this).is(":checked")) {
      $("chkPrivacyCheck1_fake,#chkPrivacyCheck1,#chkPrivacyCheck2,#chkPrivacyCheck3").attr("checked", "checked");
    } else {
      $("chkPrivacyCheck1_fake,#chkPrivacyCheck1,#chkPrivacyCheck2,#chkPrivacyCheck3").removeAttr("checked");
    }
  })


  $(document).on("click", "#chkPrivacyCheck1", function (e) {
    if ($(this).is(":checked")) {
      $("#chkPrivacyCheck1_fake,#chkPrivacyCheck1").attr("checked", "checked");
    } else {
      $("#chkPrivacyCheck1_fake,#chkPrivacyCheck1").removeAttr("checked");
    }
  })


  $(document).on("change", "#chkPrivacyCheck1_fake,#chkPrivacyCheck0,#chkPrivacyCheck1", function () {
    $("#divStdPrivError").hide();
  });
}

function initPrivacy_follow() {
  $(document).on("click", "#contact_privacy_link-follow", function (e) {
    e.preventDefault();
    $("#tbn-head-register-head-follow").hide();
    $("#divPrivacyDetails2-follow").fadeIn(10);
  });

  $(document).on("click", "#aPrivacyBack-follow", function (e) {
    e.preventDefault();
    $("#tbn-head-register-head-follow").fadeIn();
    $("#divPrivacyDetails2-follow").hide();
  });

  $(document).on("click", "#chkPrivacyCheck1_fake-follow", function () {
    if ($(this).is(":checked")) {
      $("chkPrivacyCheck1_fake-follow,#chkPrivacyCheck1-follow,#chkPrivacyCheck2-follow,#chkPrivacyCheck3-follow").attr("checked", "checked");
    } else {
      $("chkPrivacyCheck1_fake-follow,#chkPrivacyCheck1-follow,#chkPrivacyCheck2-follow,#chkPrivacyCheck3-follow").removeAttr("checked");
    }
  })


  $(document).on("click", "#chkPrivacyCheck1-follow", function () {
    if ($(this).is(":checked")) {
      $("#chkPrivacyCheck1_fake-follow,#chkPrivacyCheck1-follow").attr("checked", "checked");
    } else {
      $("#chkPrivacyCheck1_fake-follow,#chkPrivacyCheck1-follow").removeAttr("checked");
    }
  })


  $(document).on("change", "#chkPrivacyCheck1_fake-follow,#chkPrivacyCheck0-follow,#chkPrivacyCheck1-follow", function () {
    $("#divStdPrivError-follow").hide();
  });
}

function initPrivacy_poll() {
  $(document).on("click", "#contact_privacy_link-poll", function (e) {
    e.preventDefault();
    $("#tbn-head-register-head-poll").hide();
    $("#divPrivacyDetails2-poll").fadeIn(10);
  });

  $(document).on("click", "#aPrivacyBack-poll", function (e) {
    e.preventDefault();
    $("#tbn-head-register-head-poll").fadeIn();
    $("#divPrivacyDetails2-poll").hide();
  });

  $(document).on("click", "#chkPrivacyCheck1_fake-poll", function () {
    if ($(this).is(":checked")) {
      $("chkPrivacyCheck1_fake-poll,#chkPrivacyCheck1-poll,#chkPrivacyCheck2-poll,#chkPrivacyCheck3-poll").attr("checked", "checked");
    } else {
      $("chkPrivacyCheck1_fake-poll,#chkPrivacyCheck1-poll,#chkPrivacyCheck2-poll,#chkPrivacyCheck3-poll").removeAttr("checked");
    }
  })


  $(document).on("click", "#chkPrivacyCheck1-poll", function () {
    if ($(this).is(":checked")) {
      $("#chkPrivacyCheck1_fake-poll,#chkPrivacyCheck1-poll").attr("checked", "checked");
    } else {
      $("#chkPrivacyCheck1_fake-poll,#chkPrivacyCheck1-poll").removeAttr("checked");
    }
  })


  $(document).on("change", "#chkPrivacyCheck1_fake-poll,#chkPrivacyCheck0-poll,#chkPrivacyCheck1-poll", function () {
    $("#divStdPrivError-poll").hide();
  });
}


var hidePrivacy = function () {
  if ($("#divPrivacyDetails2").is(":visible")) {
    $("#divPrivacyDetails2").fadeOut();
  }
}

var hidePrivacy_follow = function () {
  if ($("#divPrivacyDetails2-follow").is(":visible")) {
    $("#divPrivacyDetails2-follow").fadeOut();
  }
}

var hidePrivacy_poll = function () {
  if ($("#divPrivacyDetails2-poll").is(":visible")) {
    $("#divPrivacyDetails2-poll").fadeOut();
  }
}

function validate(id, message) {
  var element = $('#' + id).val();
  if (element.length == 0) {
    return false;
  } else {
    return true;
  }
}

function clearize(element) {
  $(element).val("");
  $(element).hide();
}

function showError(element, message) {
  $("#" + element + "_error").html(message).fadeIn().delay(2000);
}

function showError_follow(element, message) {//si può usare l'altra
  $("#" + element + "_error-follow").html(message).fadeIn().delay(2000);
}

function showError_poll(element, message) {//si può usare l'altra
  $("#" + element + "_error-poll").html(message).fadeIn().delay(2000);
}


var fCheckMail = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
    , fCheckCell = /^3\d{2}-?\d\.?\d\.?\d\.?\d\.?\d\.?\d\.?\d?$/
    , fCheckTarga = /^([a-zA-Z]{2}\d{3}[a-zA-Z]{2})$|^(([a-zA-Z]{2}|[a-zA-Z]{4})\d{5,6})$|^([a-zA-Z]{3}\d{5})$|^([a-zA-Z]{2}\d{5}[a-zA-Z])$|^([a-zA-Z]{2}\d[a-zA-Z]\d{4})|(^[a-zA-Z]{2}\d{2}[a-zA-Z]\d{3}$)$/
    , fCheckFiscale = /^([a-zA-Z]{6}\d{2}[a-zA-Z]{1}\d{2}[a-zA-Z]{1}\d{3}[a-zA-Z]{1})$/
    , fCheckDigits = /[0-9]/
    , fCheckCell2 = /(^[012456789])|(([1]{7}|[2]{7}|[3]{7}|[4]{7}|[5]{7}|[6]{7}|[7]{7}|[8]{7}|[9]{7}|[0]{7})$)/;


function makeAlias(sTitle) {
  sTitle = replaceChart(sTitle);
  return sTitle = sTitle.toLowerCase().replace(/[ÀÁÂÃÄÅĀĂĄàáâãäåāăą]/g, 'a')
      .replace(/[ÈÉÊËĒĔĖĘĚèéêëēĕėęě]/g, 'e')
      .replace(/[ÌÍÎÏĨìíîïĩ]/g, 'i')
      .replace(/[ÒÓÔÕÖŌŎŐòóôõöōŏő]/g, 'o')
      .replace(/[ÙÚÛÜŨŪŬŮŰŲùúûüũūŭůűų]/g, 'u')
      .replace(/[^a-zA-Z0-9_-]/g, '-')
      .replace(/\-{2,}/g, '-')
      .replace(/(^\-|\-$)/g, '');
}

function resetForm($form) {
  $form.find('input:text, input:password, input:file,input:hidden, select, textarea').val('');
  $form.find('input:radio, input:checkbox')
      .removeAttr('checked').removeAttr('selected');
}

function createSuccessMessage(message) {
  var box_loader = $('<div id="box_success">');
  var span = $('<span>');
  span.attr('style', ' height: 100%; font-size: 15px; width: 100%; margin: 35px 0px 0px 0px; padding: 20px; float: left;');
  span.html(message);
  box_loader.append(span);
  $('.register-right').append(box_loader);

}

function createSuccessMessage_follow(message) {
  var box_success = $('<div id="box-success-follow">');
  var span = $('<span>');
  //span.attr('style', ' height: 100%; font-size: 15px; width: 100%; margin: 35px 0px 0px 0px; padding: 20px; float: left;');
    if (is_rating && typeof BlastingArrate !== "undefined") {
      for(i in BlastingArrate){
          if(BlastingArrate[i]._init && is_rating){
              span.html(message_78_rating + "<br><br>" + message_79_rating);
              is_rating = false;                   
              break;
          }
      }

    } else if(typeof directlive_attendee_temp_value !== "undefined" && directlive_attendee_temp_value != null) {
      span.html(message_87_direttelive);
      directlive_attendee_temp_value=null;
    } else {
    span.html(message_12);
  }
  box_success.append(span);
  $('#register-box-follow').append(box_success);
}

function createSuccessMessage_poll(message) {
  var box_success = $('<div id="box-success-poll">');
  var span = $('<span>');
  //span.attr('style', ' height: 100%; font-size: 15px; width: 100%; margin: 35px 0px 0px 0px; padding: 20px; float: left;');
    if (is_rating && typeof BlastingArrate !== "undefined") {
      for(i in BlastingArrate){
          if(BlastingArrate[i]._init && is_rating){
              span.html(message_78_rating + "<br><br>" + message_79_rating);
              is_rating = false;                   
              break;
          }
      }
    } else if(typeof directlive_attendee_temp_value !== "undefined" && directlive_attendee_temp_value != null) {
      span.html(message_87_direttelive);
      directlive_attendee_temp_value=null;
    } else {
    span.html(message_12);
  }
  box_success.append(span);
  $('#register-box-poll').append(box_success);
}

function createLoader() {
  var box_loader = $('<div id="box_loader">');
  var img = $('<img>');
  img.attr('width', '32');
  img.attr('height', '32');
  img.attr('src', cdn_resource+'/images/ajax-loader.gif');
  img.attr('style', 'float: left; margin: 84px 0px 0px 148px;');
  var span = $('<span>');
  span.attr('style', 'height: 32px; float: left; width: 200px; margin: 8px 0px 0px 90px;');
  span.text(message_11);
  box_loader.append(img);
  box_loader.append(span);
  $('.register-right').append(box_loader);
}

function createLoader_follow() {
  var box_loader = $('<div id="box-loader-follow">');
  var img = $('<img>');
  img.attr('width', '32');
  img.attr('height', '32');
  img.attr('src', cdn_resource+'/images/ajax-loader.gif');
  //img.attr('style', 'margin: 0 auto;');

  var span = $('<span>');
  //span.attr('style', ' float: left; height: 30px; margin: 0px auto; width: 100%;');
  span.text(message_11);

  box_loader.append(img);
  box_loader.append(span);

  $('#register-box-follow').append(box_loader);
}

function createLoader_poll() {
  var box_loader = $('<div id="box-loader-poll">');
  var img = $('<img>');
  img.attr('width', '32');
  img.attr('height', '32');
  img.attr('src', cdn_resource+'/images/ajax-loader.gif');
  //img.attr('style', 'margin: 0 auto;');

  var span = $('<span>');
  //span.attr('style', ' float: left; height: 30px; margin: 0px auto; width: 100%;');
  span.text(message_11);

  box_loader.append(img);
  box_loader.append(span);

  $('#register-box-follow').append(box_loader);
}

