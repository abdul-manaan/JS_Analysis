webpackJsonp([8],{"4LKs":function(e,t,o){"use strict";o.d(t,"a",function(){return w});var n=o("GiK3"),a=(o.n(n),o("fUyD")),i=o("bpks"),r=o("YS0m"),l=o("zOfx"),c=o("Pfgl"),s=o("w3lh"),u=o("ISgH"),p=o("xi/f");function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},n=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),n.forEach(function(t){y(e,t,o[t])})}return e}function f(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var _=function(){},v={headingOffset:{__style:{marginLeft:-10,marginRight:50}},mask:{baseStyles:{backgroundColor:"rgba(0,0,0, .5)",height:"100%",touchAction:"none",transitionProperty:"opacity",transitionTimingFunction:"ease-out",width:"100%",zIndex:1}},modal:{baseStyles:{border:Object(s.e)()?void 0:"1px solid #efefef",touchAction:"none",transitionProperty:"transform, opacity",transitionTimingFunction:"ease-out",width:"100vw",zIndex:1,left:0,bottom:0},baseStylesSliding:{border:Object(s.e)()?void 0:"1px solid #efefef",touchAction:"none",width:"100vw",zIndex:1,left:0,bottom:0},fullscreenStyles:{touchAction:"none",transitionProperty:"transform, opacity",transitionTimingFunction:"ease-out",width:"90vw",height:"70vh",borderRadius:"8px",zIndex:1,left:"5vw",bottom:"13vh",overflowY:"hidden"}}},w=function(e){function t(){var e,o,n,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return n=this,a=(e=g(t)).call.apply(e,[this].concat(r)),o=!a||"object"!==d(a)&&"function"!=typeof a?h(n):a,y(h(h(o)),"state",{isShowing:!1}),y(h(h(o)),"getMaskStyles",function(){var e=o.props,t=e.overrideZDepth,n=e.maskFadeInDuration,a=o.state.isShowing,i=v.mask.baseStyles;return i.zIndex=t?t-1:i.zIndex,{__style:m({},i,n?{opacity:a?1:0,transitionDuration:n}:null)}}),y(h(h(o)),"getModalStyles",function(){var e=o.props,t=e.overrideZDepth,n=e.modalFadeInDuration,a=e.slideUpDuration,i=e.isFullscreen,r=o.state.isShowing,l=i?v.modal.fullscreenStyles:v.modal.baseStyles;return l.zIndex=t||l.zIndex,{__style:m({},l,a?{transform:r?"translateY(0)":"translateY(100vh)",transitionDuration:a}:{},n?{opacity:r?1:0,transitionDuration:n}:{})}}),y(h(h(o)),"getModalStylesSlideUp",function(){var e=o.props.overrideZDepth,t=o.state.isShowing,n=v.modal.baseStylesSliding;return n.zIndex=e||n.zIndex,{__style:m({},n,{transition:"all 225ms cubic-bezier(0.0,0.0,0.2,1) 500ms",transform:t?"translateY(0)":"translateY(100vh)"})}}),y(h(h(o)),"preventModalScroll",function(e){e.preventDefault()}),o}var o,s,w;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,n["Component"]),o=t,(s=[{key:"componentDidMount",value:function(){var e=this;this.props.isOpen&&r.a.pause(),this.requestAnimationFrameId=Object(u.k)(function(){return e.setState({isShowing:!0})})}},{key:"componentDidUpdate",value:function(e){this.props.isOpen&&!e.isOpen?r.a.pause():!this.props.isOpen&&e.isOpen&&r.a.resume()}},{key:"componentWillUnmount",value:function(){this.props.isOpen&&r.a.resume(),window.cancelAnimationFrame(this.requestAnimationFrameId)}},{key:"render",value:function(){var e=this.props,t=e.accessibilityCloseIconLabel,o=e.children,r=e.isOpen,s=e.hideCloseIcon,u=e.onDismiss,d=e.overrideZDepth,m=e.heading,f=e.isSlideUp,g=e.childPaddingX,b=e.childPaddingY,h=e.enableCloseIconBackground,y=e.onCloseIconDismiss,w=e.isFullscreen,k=this.getMaskStyles(),O=f?this.getModalStylesSlideUp():this.getModalStyles();return r&&n.createElement(l.a,null,n.createElement(p.m,null,n.createElement(p.b,{display:"inlineBlock"},n.createElement(c.a,{onTouch:u||_,pressState:"background"},n.createElement(p.b,{position:"fixed",top:!0,left:!0,onTouchMove:this.preventModalScroll,dangerouslySetInlineStyle:k})),h&&n.createElement(p.b,{top:!0,left:!0,position:"fixed",dangerouslySetInlineStyle:{__style:{zIndex:d||v.modal.baseStyles.zIndex}}},n.createElement(i.a,{accessibilityLabel:a.a._("close icon background","accesibility label for close icon on a overlay"),icon:"cancel",onTouch:y,padding:5,size:20,color:"white"})),n.createElement(p.b,{position:"fixed",color:"white",onTouchMove:this.preventModalScroll,dangerouslySetInlineStyle:O},t&&!s&&n.createElement(p.b,null,n.createElement(p.b,{flex:"grow",display:"flex",alignItems:"center"},n.createElement(p.b,{display:"flex",alignItems:"center"},n.createElement(i.a,{accessibilityLabel:t,icon:"cancel",onTouch:u,padding:5,size:20})),n.createElement(p.b,{display:"flex",flex:"grow",alignItems:"center",justifyContent:"center",dangerouslySetInlineStyle:v.headingOffset},w?m:n.createElement(p.B,{align:"center",bold:!0,size:"xl"},m))),!w&&n.createElement(p.e,null)),n.createElement(p.b,{paddingX:g,paddingY:b},o)))))}}])&&f(o.prototype,s),w&&f(o,w),t}();y(w,"defaultProps",{childPaddingX:3,childPaddingY:3})},kGXH:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("GiK3"),a=o.n(n),i=o("RH2O"),r=o("f8Wt"),l=o("2LZS"),c=o("CEfU"),s=o("fUyD"),u=o("4LKs"),p=o("8Yp0"),d=o("sH4p"),m=o("qTfT"),f=o("vHl6"),g=o("2fqb"),b=o("+604"),h=o("/hEK"),y=o("UP2y"),_=o("dwxa"),v=o("NsDl"),w=o("xi/f"),k=o("c9Fv"),O=o("Po4C");function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}o.d(t,"track",function(){return F});var F=function(e,t,o,n){Object(p.a)("".concat(n?"".concat(n,"."):"","mweb_autologin.").concat(t,"_").concat(e,".").concat(o))},P=function(e){function t(){var e,o,n,a,i,r,l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var c=arguments.length,s=new Array(c),u=0;u<c;u++)s[u]=arguments[u];return n=this,o=!(a=(e=A(t)).call.apply(e,[this].concat(s)))||"object"!==S(a)&&"function"!=typeof a?E(n):a,i=E(E(o)),l={fbEmail:null,fbName:null,showFbAutoLoginModal:!1,facebookAutologinFailed:!1,googleAutologinFailed:!1,smartlockAutologinFailed:!1},(r="state")in i?Object.defineProperty(i,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):i[r]=l,o}var o,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,n["Component"]),o=t,(i=[{key:"componentDidUpdate",value:function(e,t){var o=this.props.trackAutologinFailure,n=this.state,a=n.facebookAutologinFailed,i=n.googleAutologinFailed,r=n.smartlockAutologinFailed;a&&i&&r&&o()}},{key:"componentDidMount",value:function(){var e=this.props,t=e.isAuthenticated,o=e.crossDomain,n=e.fb,a=e.google,i=e.smartlock,l=e.getDisableFBAutoLoginExperimentGroup;t||(r.a("fba")?Object(p.a)("mweb_previously_logged_out.true"):Object(p.a)("mweb_previously_logged_out.false"),o&&this.attemptCrossDomainAutologin(),i&&this.attemptSmartlockAutologin(),n&&(l().startsWith("enabled")||this.attemptFBAutologin()),a&&this.attemptGoogleAutologin())}},{key:"attemptCrossDomainAutologin",value:function(){var e=this.props,t=e.logPrefix,o=e.pageName;(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!Object(v.c)(window.location.origin)||Object(f.g)()?Promise.reject({status:"autologin_disabled"}):(e&&e.onAttempt&&e.onAttempt(),Object(v.d)())})({onAttempt:function(){return F("attempt","cctld",o,t)}}).then(O.a).then(function(){return F("success","cctld",o,t)}).catch(function(e){e&&F("fail","cctld",o,t)})}},{key:"attemptSmartlockAutologin",value:function(){var e,t=this,o=this.props,n=o.history,a=o.location,i=o.login,r=o.logPrefix,l=o.pageName,c=o.getSmartLockAutoLoginExperimentGroup;c().startsWith("enabled_mediation_required")?e="required":c().startsWith("enabled_mediation_optional")?e="optional":c().startsWith("enabled_mediation_silent")&&(e="silent"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,o=window.navigator.credentials,n={password:!0};return t&&(n.mediation=t),Object(f.g)()?Promise.reject({status:"autologin_disabled"}):new Promise(function(t){o&&(e&&e.onAttempt&&e.onAttempt(),o.get(n).then(t))})}({onAttempt:function(){return F("attempt","smartlock",l,r)}},e).then(function(e){e?(Object(b.d)({event_type:7534,view_type:10,view_parameter:3204,aux_data:{signup_login_method:5}}),i({username_or_email:e.id,password:e.password},n,a.pathname,{isAutologin:!0}).then(function(){F("success","smartlock",l,r),Object(b.d)({event_type:7536,view_type:10,view_parameter:3204,aux_data:{signup_login_method:5}})}).catch(function(){F("fail","smartlock",l,r),Object(b.d)({event_type:7535,view_type:10,view_parameter:3204,aux_data:{signup_login_method:5}}),t.setState({smartlockAutologinFailed:!0})})):t.setState({smartlockAutologinFailed:!0})}).catch(function(e){t.setState({smartlockAutologinFailed:!0}),F(e?e.status:"error_other","smartlock",l,r)})}},{key:"handleFBAutologinResponse",value:function(e){var t=this.props,o=t.logPrefix,n=t.pageName,a=t.onFBAutoLoginFailure;F(e,"facebook",n,o),"success"!==e&&a&&a({status:e})}},{key:"handleFBAutologinError",value:function(e){var t;e?e.status?t=e.status:e instanceof Error?(t="error_no_status",Object(g.a)({message:e.message||e.description,lineNumber:e.lineno||e.lineNumber||e.line,columnNumber:e.colno||e.columnNumber||e.column,stack:e.stack||e.stacktrace||e.error&&(e.error.stack||e.error.stacktrace),fileName:e.fileName||e.sourceUrl,name:"unexpected mweb facebook autologin response error"})):"string"==typeof e?(t="error_string",Object(g.a)({message:e,name:"unexpected mweb facebook autologin response string"})):t="error_other":t="error_empty",this.handleFBAutologinResponse(t)}},{key:"attemptFBAutologin",value:function(){var e=this,t=this.props,o=t.history,n=t.locale,a=t.location,i=t.login,r=t.logPrefix,l=t.pageName,c=t.showToast;F("attempt","facebook",l,r),function(e){return Object(f.g)()?Promise.reject({status:"autologin_disabled"}):Object(_.f)(e).then(_.d).then(function(e){return Object(_.e)(e,{autologin:!0})})}(n).then(function(t){e.setState({showFbAutoLoginModal:!0,fbEmail:t.data&&t.data.email,fbName:t.data&&t.data.first_name}),Object(b.d)({event_type:7534,view_type:10,view_parameter:3205,aux_data:{signup_login_method:2}}),i(t.creds,o,a.pathname,{isAutologin:!0}).then(function(){e.setState({showFbAutoLoginModal:!1}),Object(b.d)({event_type:7536,view_type:10,view_parameter:3205,aux_data:{signup_login_method:2}}),c({text:t.data&&t.data.first_name?s.a.interpolateNamedTemplate(s.a._("Welcome back to Pinterest, {{ name }}!","welcoming user back to pinterest when autologin with first name"),{name:t.data.first_name}).join(""):s.a._("Welcome back to Pinterest!","welcoming user back to pinterest when autologin"),duration:4e3}),e.handleFBAutologinResponse("success")}).catch(function(t){e.setState({showFbAutoLoginModal:!1,facebookAutologinFailed:!0}),Object(b.d)({event_type:7535,view_type:10,view_parameter:3205,aux_data:{signup_login_method:2}});var o="fail";t&&t.apiErrorCode===f.a&&(o="incomplete_signup"),e.handleFBAutologinResponse(o)})}).catch(function(t){e.handleFBAutologinError(t),e.setState({facebookAutologinFailed:!0})})}},{key:"attemptGoogleAutologin",value:function(){var e=this,t=this.props,o=t.history,n=t.location,a=t.login,i=t.logPrefix,r=t.pageName,l=t.showToast;F("attempt","google",r,i),function(){if(Object(f.g)())return Promise.reject({status:"autologin_disabled"});var e=document.createElement("div");return e.style.left="-99999px",e.style.opacity="0",e.style.position="fixed",e.style.top="-999999px",document.getElementsByTagName("body")[0].appendChild(e),Object(y.b)(e,!0)}().then(function(t){var c=t.data;c?(Object(b.d)({event_type:7534,view_type:10,view_parameter:3204,aux_data:{signup_login_method:3}}),a(c,o,n.pathname,{isAutologin:!0}).then(function(){l({text:s.a._("Welcome back to Pinterest!","welcoming user back to pinterest when autologin"),duration:4e3}),F("success","google",r,i),Object(b.d)({event_type:7536,view_type:10,view_parameter:3204,aux_data:{signup_login_method:3}})}).catch(function(){e.setState({googleAutologinFailed:!0}),F("fail","google",r,i),Object(b.d)({event_type:7535,view_type:10,view_parameter:3204,aux_data:{signup_login_method:3}})})):e.setState({googleAutologinFailed:!0})}).catch(function(t){e.setState({googleAutologinFailed:!0}),F(t?t.status:"error_other","google",r,i)})}},{key:"render",value:function(){var e=this.state,t=e.fbEmail,o=e.fbName,n=e.showFbAutoLoginModal;return a.a.createElement(u.a,{isOpen:n},a.a.createElement(w.b,{margin:-3},a.a.createElement(l.a,{duration:1500,finalProgress:95}),a.a.createElement(w.b,{alignItems:"center",direction:"column",display:"flex",paddingX:t?10:12,paddingY:6},a.a.createElement(w.i,{icon:"pinterest",color:"red",accessibilityLabel:s.a._("Pinterest logo"),size:24}),a.a.createElement(w.b,{marginTop:1,paddingY:1},a.a.createElement(w.B,{align:"center"},a.a.createElement(w.h,{size:"xs"},o?s.a.interpolateNamedTemplate(s.a._("Welcome back, {{ name }}!","welcome back with first name"),{name:o}).join(""):s.a._("Welcome back!","Welcome back!")))),a.a.createElement(w.B,{align:"center"},t?s.a.interpolateNamedTemplate(s.a._("We're logging you in with your Facebook account, {{ email }}","logging in user with facebook account and email associated"),{email:a.a.createElement(w.B,{bold:!0,inline:!0,key:"fbEmail"},t)}):s.a._("We're logging you in with your Facebook account...","logging in user with Facebook account")))))}}])&&j(o.prototype,i),c&&j(o,c),t}();t.default=Object(k.compose)(d.b,Object(i.connect)(function(e,t){return{isAuthenticated:e.session.isAuthenticated,locale:e.session.locale,pageName:Object(c.a)(t.location.pathname,e)}},function(e){return{login:function(t,o,n,a){return e(Object(O.b)(t,o,n,a))},crossDomainAutoLogin:function(){return e(Object(O.a)())},getSmartLockAutoLoginExperimentGroup:function(){return e(Object(m.a)("mweb_smartlock_auto_login"))||""},getDisableFBAutoLoginExperimentGroup:function(){return e(Object(m.a)("mweb_unauth_fb_api_fetch_sdk_for_autologin"))||""},trackAutologinFailure:function(){return e(Object(h.y)())}}}))(P)}});