/*
 spux-1.5.1.js
 Copyright (c) 2018 Rakuten.Inc
 Date: 2018-06-19 14:30:04
*/

Rmodules&&"function"==typeof Rmodules.define&&Rmodules.define(["jQuery","R^1","R.ui^1","R.api^1"],function(a,b){"use strict";function c(a,d){var e;for(e in a)Object.hasOwnProperty(a,e)&&(d&&b.isPlainObject(a[e])&&c(a[e]),a[e.toLowerCase()]=a.key,delete a[e])}function d(a,c,d){if(!b.isString(a))return a;var e,f,g,h=a.split(c),i=[];for(d||(d=b.trim),f=0,g=h.length;g>f;f++)e=d(h[f]),e&&i.push(e);return i}function e(a){var c,d,e,f,g;if(a&&b.isString(a))for(a=a.split(";"),c={},f=0,g=a.length;g>f;f++)d=a[f].split(":"),
e=d[0].toLowerCase(),c[e]=d[1];else c=a||{};return c}function f(a){var d,e,f,g;if(b.isString(a))for(a=a.split(";"),d=[],f=0,g=a.length;g>f;f++)e=a[f].split(":"),d.push({type:e[0].toLowerCase(),rate:parseFloat(e[1])});else d=c(a);return d}function g(a){var b,c,e,g={},h=d(a,"#");for(c=0,e=h.length;e>c;c++)b=h[c].split("@"),g[b[0].toLowerCase()]=f(b[1]);return g}function h(a){var c,d,e,f,g;if(b.isString(a)&&a.length>0)for(a=a.split(";"),c={},f=0,g=a.length;g>f;f++)d=a[f].split(":"),e=b.enums.UserRank[d[0].toUpperCase()],
e&&(c[e]=parseFloat(d[1]));else c=a;return c}function i(a){var c,d,e,f;if(b.isString(a))for(c=[],a=a.split(";"),e=0,f=a.length;f>e;e++)d=b.enums.PointType[a[e].toUpperCase()],d&&c.push(d);else c=a;return c}function j(a){var d,e,f,g;if(b.isString(a)){if(a)for(d={},a=a.split(","),f=0,g=a.length;g>f;f++)e=a[f].split(":"),d[e[0].toLowerCase()]=parseInt(e[1],10)}else d=c(a);return d}function k(a){var c,d,e,f,g;if(b.isNumber(a))c=parseFloat(a);else if(a&&b.isString(a))for(c={},a=a.split(","),e=0,f=a.length;f>e;e++)d=a[e].split(":"),
g=b.enums.PointType[L[d[0].toLowerCase()]]||b.enums.PointType[d[0].toUpperCase()],g&&(c[g]=parseFloat(d[1]));return c}function l(c,d){function g(c,g){function k(a){var b,c,e=M[a];return g&&g.serviceNames&&(b=g.serviceNames[e]),b||(b=P.global.serviceNames[e]),!b&&e&&(c=d.getService(e),b=c?c.name:void 0),b}var l,m,n,o,p,q,r,s,t,u,v=[],w={};if(!d)return void 0;for((b.isDom(c)||c instanceof a)&&(g=a.extend(a(c).data(),g),c=g.price),m=d.totalRate,c=c||0,g=g||{},l=d.getAllServices(!1),s=h(g.userRankRate||g.henbai),
g.serviceNames=e(g.serviceNames),n=0,o=l.length;o>n;n++)p=l[n].service,q=b.enums.PointType[L[p.id.toLowerCase()]],v.push({type:q||b.enums.PointType.DEFAULT,rate:p.rate,data:{id:p.id,name:p.name}});if(g&&g.extraRate)for(r=f(g.extraRate),n=0,o=r.length;o>n;n++)p=r[n],t=p.rate,q=b.enums.PointType[L[p.type.toLowerCase()]],v.push({type:q||b.enums.PointType.DEFAULT,rate:t,data:{id:p.id||p.type.toLowerCase(),name:p.name}});for(u={userRankRate:s,userRank:P.global.userRank||d.userRank,itemType:g.itemType,
shopId:g.shopId,accept:i(g.accept),ignore:i(g.ignore),whitePoints:i(g.whitePoints),blackPoints:i(g.blackPoints),whiteRates:i(g.whiteRates),blackRates:i(g.blackRates),itemsOrder:j(g.itemsOrder||P.display.breakDownOrder),minPrice:P.display.minPrice,booksShopIds:P.global.booksShopIds},w=b.getPointDetails(c,v,u),n=0,o=w.items.length;o>n;n++)p=w.items[n],p.id=p.id||M[p.type],p.name=k(p.type)||p.name;return w}function k(c){function e(b){function c(a,b){if(a.id!==e&&b.id!==e)return 0;var c=f.indexOf(a.id),d=f.indexOf(b.id);
return c-d}var e="rakutenbooks",f=a.map(d.getAllServices(!0),function(a){return a.service.id});b.sort(c)}var f,h,i,k,l,m,n,o,p,q,r=a.extend({},P.display,c),s=a(r.parent).find(r.sDisplayElements).not("."+r.cDisplayedElements);for(i=0,k=s.length;k>i;i++){for(f=s.eq(i),h=f.data(),o={extraRate:h[r.dataExtraRate],userRankRate:h[r.dataUserRankRate]||h[r.dataHenbai],userRank:P.global.userRank||d.userRank,shopId:h[r.dataShopId],genreId:h[r.dataGenreId],itemType:h[r.dataItemType],accept:h[r.dataAccept],ignore:h[r.dataIgnore],
whitePoints:h[r.dataWhitePoints],blackPoints:h[r.dataBlackPoints],whiteRates:h[r.dataWhiteRates],blackRates:h[r.dataBlackRates],itemsOrder:j(r.itemsOrder||P.display.breakDownOrder)},p=g(h[r.dataPrice],o),e(p.items),h={"#USER_RANK#":d.getUserRankString(P.global.userRank),"#TOTAL_RATE#":p.totalRate,"#ITEM_POINTS#":p.totalPoints,"#ITEM_POINTS_FORMATTED#":b.display.formatNumber(p.totalPoints),"#SUPER_DEAL_PERCENT#":p.superDealRate},h["#NZ_POINTS#"]=p.totalPoints>0?b.applyTemplate(r.templateNzPoints,h):"",
h["#NZ_RATE#"]=p.totalRate>1?b.applyTemplate(r.templateNzRate,h):"",h["#NZ_SUPER_DEAL#"]=p.superDealRate>0?b.applyTemplate(r.templateNzSuperDeal,h):"",q=[],l=0,m=p.items.length;m>l;l++)n=p.items[l],q.push(b.applyTemplate(r.templateItem,{"#SERVICE_ID#":M[n.type]||n.id,"#SERVICE_NAME#":n.name||"","#SERVICE_RATE#":n.rate||0,"#SERVICE_POINTS#":n.points||0},!1));h["#POINTS_BREAKDOWN#"]=q.join(""),f.html(b.applyTemplate(r.template,h,!1)).addClass(r.cDisplayedElements)}return s}var l={Cases:I,type:c,data:d,
getInfo:g,displayPoints:k};return P.display.onError||c!==I.ERROR?(P.display.enabled&&(P.display.waitDom?a(k):k()),Q.def.resolve(l)):Q.def.reject(),a(P.css.sEventElem).trigger(P.global.componentEvent,l),Q.def.promise()}function m(a){var c=b.find(I,function(b){return b===a});return b.isString(c)?c.toLowerCase():""}function n(a,b,c){function d(){var b,c,d,e=[];for(c=0,d=a.sections.length;d>c;c++)(b.totalRate>0||P.sc.includeUnusedSections)&&e.push(P.sc.formatSection.replace(/#SECTION_ID#/g,b.id).replace(/#SECTION_NAME#/g,b.name).replace(/#SECTION_TOTALRATE#/g,b.totalRate));
return e.join(P.sc.formatSectionSeparator)}function e(){var b,c,d,e,f,g,h=[];for(d=0,e=a.sections.length;e>d;d++)for(b=a.sections[d],f=0,g=b.services.length;g>f;f++)c=b.services[f],(c.isQualified||P.sc.includeUnusedServices)&&h.push(P.sc.formatService.replace(/#SERVICE_ID#/g,c.id).replace(/#SERVICE_NAME#/g,c.name).replace(/#SERVICE_RATE#/g,c.rate).replace(/#SERVICE_QUALIFIES#/g,c.isQualified?1:0));return h.join(P.sc.formatServiceSeparator)}var f="",g="";return a&&(-1!==b.indexOf("#SERVICES#")&&(g=e()),
-1!==b.indexOf("#SECTIONS#")&&(f=d())),b.replace(/#TOTALRATE#/g,a?a.totalRate:0).replace(/#USERRANK#/g,a?a.getUserRankString(P.global.userRank):"na").replace(/#SOURCE#/g,P.spu.source.toLowerCase()).replace(/#VIEWTYPE#/g,P.spu.viewType.toLowerCase()).replace(/#CASE#/g,m(c)).replace(/#SECTIONS#/g,f).replace(/#SERVICES#/g,g)}function o(a,b,c,d){var e={};return e[a]=n(b,c,d),e}function p(a,b,c,d){function e(){return P.spu.itemId?[P.spu.shopId||"",P.spu.itemId].join("/"):""}var f,g,h,i,j,k,l={accountId:P.rat.accountId,
serviceId:P.rat.serviceId,options:["url","ua"],pData:{itemId:e(),pgn:P.spu.viewType,pgl:P.spu.source,abtest:n(a,c,b)},cpData:{}};if(d&&(l.eventType=d),a)for(l.cpData.total=a.totalRate,f=0,g=a.sections.length;g>f;f++)if(h=a.sections[f],h.totalRate>0||P.rat.includeUnusedSections)for(l.cpData["sec_"+h.id]=h.totalRate,i=0,j=h.services.length;j>i;i++)k=h.services[i],(k.isQualified||P.rat.includeUnusedServices)&&(l.cpData["srv_"+k.id]=k.rate);return l}function q(a,c){var d=c.split(",");return-1!==b.find(d,function(c){
return I[b.trim(c).toUpperCase()]===a})}function r(c,d){var e=!0;a(P.css.sTrackingClick).on("hover"===P.popup.displayOn?"mouseover":"click",function(){e&&(e=!1,P.sc.sendShowEnabled&&q(c,P.sc.sendShowOn)&&b.sendToSc(o(P.sc.sendShowProp,d,P.sc.sendShowFormat,c)),P.rat.sendShowEnabled&&q(c,P.rat.sendShowOn)&&b.sendToRat(p(d,c,P.rat.sendShowCaseName,"hover"===P.popup.displayOn?"mouseover":void 0)))})}function s(c,d){var e,f={displayClass:P.css.cPopupDisplay,showDelay:P.popup.showDelay,hideDelay:P.popup.hideDelay,
checkDelay:P.popup.checkDelay,onBeforeShow:function(b){u(Q.popupServices[a(b.currentTarget).data("service-id")],!1)}};q(c,P.popup.enableOn)&&("click"===P.popup.displayOn?(e=P.css.sPopupTrigger===P.css.sIcon?O.iconContainer:O.iconContainer.find(P.css.sPopupTrigger),b.enableOnClick(e,O.popupContainer,O.popupCloseButton,f)):"hover"===P.popup.displayOn&&b.enableOnHover(O.iconContainer,O.popupContainer,f))}function t(a){var b,c,d=P.css,e={};e[I.NOT_LOGGED]=d.sCaseNologin,e[I.NONE]=d.sCase1,e[I.NORMAL]=d.sCaseN,
e[I.ERROR]=d.sCaseError,e[I.SUPER_DEAL]=d.sCaseSuperdeal,e[I.DISABLED]=d.sCaseDisabled,c="."+e[a].substring(1);for(b in O.templates)O.templates[b][J.ICON].not(c).remove(),O.templates[b][J.POPUP].not(c).remove()}function u(c,d){var e,f,g,h,i=c,j=a(P.css.sPopupServices);void 0===i&&(i=Q.popupActiveServiceIndex),g="window"===P.popup.viewWidth?a(window).width():j.outerWidth(!0),h={scrollLeft:g*i},d===!1&&(e=0),i!==Q.popupActiveServiceIndex&&void 0!==Q.popupActiveServiceIndex&&Q.popupSlideshow.getItem(Q.popupActiveServiceIndex).removeClass(P.css.cServiceActive),
Q.popupSlideshow.getItem(i).addClass(P.css.cServiceActive),f=j.find(P.css.sPopupServiceContainer)[c],f&&(f.scrollTop=0),Q.popupSlideshow.scrollToItem(i,b.ui.Slideshow.ItemAlign.CENTER,e),j.stop().animate(h,e),Q.popupActiveServiceIndex=i}function v(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=!1;if(d){for(o={},p=0,q=d.sections.length;q>p;p++)n=d.sections[p],o["#SECTION_"+n.id.toUpperCase()+"_TOTAL_RATE#"]=n.totalRate,o["#SECTION_"+n.id.toUpperCase()+"_NAME#"]=n.name;e=O.templates[c],r=[];for(var t in e){
if(s=t===J.POPUP,f=e[t],g=f.find("."+P.css.cTemplateSectionsPlaceholders),g.length>0&&g.html(b.applyTemplate(g.html(),o)),h=f.find("."+P.css.cTemplateSection),h.length>0){for(i=h[0].outerHTML,p=0,q=d.sections.length;q>p;p++)n=d.sections[p],(P.global.showEmptySections||n.services.length>0)&&(m=x(n,i,s),s&&a.merge(r,m.servicesTemplateData),(P.global.showEmptySections||m.servicesTemplateData.length>0)&&h.before(m.$element));h.remove()}P.slideshow.enabled&&(j=f.find(P.css.sPopupServicesIndex)),j&&j.length>0&&(k=j.find(P.css.sPopupServicesIndexItem),
l=k[0].outerHTML,k.remove(),Q.popupSlideshow=w(j,l,r))}O.totalRate.html(d.totalRate)}}function w(c,d,e){var f=b.browser.isMobile?b.ui.Slideshow.getSpOptions():b.ui.Slideshow.getPcOptions(),g={noPagination:!P.slideshow.pagination,scrollMode:P.slideshow.scrollMode,onItemClick:function(a,b){u(b)},onResize:function(){u()}};return new b.ui.Slideshow(c,{itemWidth:P.display.popupServicesIndexItemSize,itemTemplate:{html:d,data:e}},a.extend({},f,g))}function x(c,d,e){var f,g,h,i,j,k,l,m=z(c),n={$element:a(b.applyTemplate(d,m,!1)).removeClass(P.css.cTemplateSection),
servicesTemplateData:[]};if(f=n.$element.find("."+P.css.cTemplateService),f.length>0){for(g=f[0].outerHTML,l=Object.keys(Q.popupServices).length,j=0,k=c.services.length;k>j;j++)h=c.services[j],(P.global.showEmptyServices||h.rate>0)&&(i=y(h,g),f.before(i.$element),n.servicesTemplateData.push(i.templateData),e&&(Q.popupServices[h.id]=l,l++));f.remove()}return n}function y(c,d){var e=A(c),f={$element:a(b.applyTemplate(d,e,!1)).removeClass(P.css.cTemplateService),templateData:e};return c.link||f.$element.find(P.css.sServiceLink).remove(),
f}function z(a){return{"#SECTION_ID#":a.id,"#SECTION_NAME#":b.truncate(a.name,P.global.sectionNameMaxLength),"#SECTION_FULLNAME#":a.name,"#SECTION_ICONSUBTITLE#":a.iconSubtitle||"","#SECTION_POPUPSUBTITLE#":a.popupSubtitle||"","#SECTION_TOTALRATE#":a.totalRate}}function A(a){var c;return a.isQualified?c=P.css.cServiceQualifies:a.isNew&&(c=P.css.cServiceNew),{"#SERVICE_ID#":a.id,"#SERVICE_NAME#":a.alias||b.truncate(a.name,P.global.serviceNameMaxLength),"#SERVICE_BRIEF#":a.brief||"","#SERVICE_FULLNAME#":a.name,
"#SERVICE_RATE#":a.rate,"#SERVICE_LINK#":b.getTrackingLinks(a.link,P.sc),"#SERVICE_STATE#":c,"#SERVICE_DISCLAIMER#":a.disclaimer||""}}function B(a,b){var c,d,e,f,g,h;for(a.addClass(P.css.cTotalRate.replace(/#TOTAL_RATE#/g,b.totalRate)).addClass(P.css.cUserRank.replace(/#USER_RANK#/g,b.getUserRankString(P.global.userRank))),c=0,e=b.sections.length;e>c;c++)for(d=b.sections[c],f=0,h=d.services.length;h>f;f++)g=d.services[f],g.isQualified&&a.addClass(P.css.cQualifiesService.replace(/#SERVICE_ID#/g,g.id));
}function C(c){function d(a,b){var c,d;if(b.hasClass(P.css.cTogglerHidden)){for(c=0,d=o.length;d>c;c++)o.eq(c).addClass(P.css.cTogglerHidden);n.addClass(P.css.cTogglerHidden),a.removeClass(P.css.cTogglerHidden),b.removeClass(P.css.cTogglerHidden)}else a.addClass(P.css.cTogglerHidden),b.addClass(P.css.cTogglerHidden)}function e(a,b){return function(){a.toggleClass(P.css.cTogglerHidden),b.toggleClass(P.css.cTogglerHidden)}}function f(a,b){return function(){d(a,b)}}var g,h,i,j,k,l,m,n=c.find(P.css.sSectionToggler),o=a();
for(k=0,l=n.length;l>k;k++)g=n.eq(k),j=g.data("toggle"),j&&(h=c.find(j),o=o.add(h),"toggle"===P.popup.toggleType?g.click(e(g,h)):"accordion"===P.popup.toggleType&&g.click(f(g,h)));if("ALL"!==P.popup.toggleShow.toUpperCase())for(n.addClass(P.css.cTogglerHidden),o.addClass(P.css.cTogglerHidden),i=P.popup.toggleShow.split(","),k=0,l=i.length;l>k;k++)b.isNumeric(i[k])?(m=parseInt(i[k],10)-1,n.eq(m).removeClass(P.css.cTogglerHidden),o.eq(m).removeClass(P.css.cTogglerHidden)):(o.filter('[data-toggle="'+i[k]+'"]').removeClass(P.css.cTogglerHidden),
o.filter(i[k]).removeClass(P.css.cTogglerHidden))}function D(a){var c,d,e,f,g,h,i,j,k,l,m="bonusPoint",n=1,o="shopPoint",p=P.global.disabledSections,q=P.global.disabledServices,r=P.global.overrideData,s=P.global.sectionNames,t=P.global.serviceNames,u=P.global.extraRate,v=P.global.userRankRate;for(i=0,j=p.length;j>i;i++)a.removeSection(p[i]);for(i=0,j=q.length;j>i;i++)a.removeService(q[i]);for(i in u)for(e=u[i],d=a.getSection(i),d||(d=new b.api.spu.SpuSection({id:i,name:s[i],totalRate:0,services:[]
}),a.addSection(d)),k=0,j=e.length;j>k;k++)f=e[k],d.addService(new b.api.spu.SpuSectionService({id:f.type,name:t[f.type],rate:f.rate,qualified:!0}));if(v&&(c=a.getService(o),f=v[P.global.userRank||a.userRank]||0,c?(c.rate+=f,c.parent.totalRate=+f,c.parent.parent.totalRate+=f):(d=a.getSection(m),d||(d=new b.api.spu.SpuSection({id:m,name:s[m.toLowerCase()],totalRate:f,services:[]}),a.addSection(d,!1,n)),d.addService(new b.api.spu.SpuSectionService({id:o,name:t[o.toLowerCase()],rate:f,qualified:!0})))),
r)for(i=0,j=a.sections.length;j>i;i++)if(d=a.sections[i],g=r[b.api.spu.getOriginalSectionId(d.id)],g&&(g.name&&(d.name=g.name),g.iconSubtitle&&(d.iconSubtitle=g.iconSubtitle),g.popupSubtitle&&(d.popupSubtitle=g.popupSubtitle),g.services))for(k=0,l=d.services.length;l>k;k++)c=d.services[k],h=g.services[b.api.spu.getOriginalServiceId(c.id)],h&&(h.alias&&(c.alias=h.alias),h.brief&&(c.brief=h.brief),h.name&&(c.name=h.name),void 0!==h["new"]&&(c.isNew=h["new"]))}function E(a){function b(a,b,c,d){if(a.id===b.id)return 0;
var e=c[a.id]||0,f=c[b.id]||0;return 0===e&&0===f?d.indexOf(a.id)-d.indexOf(b.id):e-f}function c(a){var b,c,d,e={};for(c=0,d=a.length;d>c;c++)b=a[c].split(":"),e[b[0]]=b[1];return e}function d(){var b,c,d=[];for(b=0,c=a.sections.length;c>b;b++)d.push(a.sections.id);return d}function e(){var b,c,d,e,f=[];for(b=0,c=a.sections.length;c>b;b++)for(d=0,e=a.sections[b].services.length;e>d;d++)f.push(a.sections[b].services[d].id);return f}function f(a,c){return b(a,c,k,i)}function g(a,c){return b(a,c,l,j);
}function h(a){for(var b=a.length-1;b>=0;b--)a[b]||a.splice(b,1);return a}if(a){var i,j,k,l,m,n,o=h(P.global.orderSections.split(",")),p=h(P.global.orderServices.split(","));if(o.length&&(k=c(o),i=d(),a.sections.sort(f)),p.length)for(l=c(p),j=e(),m=0,n=a.sections.length;n>m;m++)a.sections[m].services.sort(g)}}function F(a,c){var d,e=O.iconContainer.add(O.popupContainer);t(a),D(c),E(c),v(a,c),O.icon.children().appendTo(O.iconContainer),O.popup.children().appendTo(O.popupContainer),c&&B(e,c),s(a,c),
C(O.popupContainer),r(a,c),d=l(a,c),e.data(P.global.componentData,d),e.addClass(P.css.cReady),P.sc.sendDataEnabled&&b.sendToSc(o(P.sc.sendDataProp,c,P.sc.sendDataFormat,a)),P.rat.sendDataEnabled&&b.sendToRat(p(c,a,P.rat.sendDataCaseName))}function G(){function c(a,b){var c,d;if(a){for(c in b)d=P.global.globalReplacement.replace("%",c.toUpperCase()),a=a.replace(new RegExp(d,"g"),b[c]);return a}}function d(b){var c,d,e;for(d=0,e=b.length;e>d;d++)c=a.extend(c,b.eq(d).data());return c||{}}var e,f,g,h=P.css,i={
NOT_LOGGED:h.sCaseNologin,NONE:h.sCase1,NORMAL:h.sCaseN,ERROR:h.sCaseError,SUPER_DEAL:h.sCaseSuperdeal,DISABLED:h.sCaseDisabled},j=b.getNextElement(h.sIcon),k=b.getNextElement(h.sPopup),l=j.find('script[type="text/template"]'),m=k.find('script[type="text/template"]'),n=l.last().html(),o=m.last().html();n=c(n,d(O.settings.find(N.config.templateIconData))),o=c(o,d(O.settings.find(N.config.templatePopupData))),e=a("<div>").append(n),f=a("<div>").append(o),l.remove(),m.remove(),O.iconContainer=j,O.popupContainer=k,
O.icon=e,O.popup=f,O.totalRate=e.find(h.sTotalRate).add(f.find(h.sTotalRate)),O.popupCloseButton=e.find(h.s_popup_close_button).add(f.find(h.sPopupCloseButton)),O.templates={};for(g in i)O.templates[I[g]]={},O.templates[I[g]][J.ICON]=O.icon.find(i[g]),O.templates[I[g]][J.POPUP]=O.popup.find(i[g]);return O.icon.length&&O.iconContainer.length||O.popup.length&&O.popupContainer.length}function H(){if(P&&G()){var c=P.spu.defaultOnNotLogged?K:null;if(P.global.useTemplate&&!P.spu.enabled)F(P.global.useTemplate,c);else if(b.user.isLogged(P.global.userLogged)){
var d=a('[name="head"]').attr("name",null);b.api.spu.loadSpu(a.extend({},P.spu,{encoding:P.spu.encoding,sid:P.spu.sid,source:P.spu.source,viewType:P.spu.viewType,userRank:P.spu.userRank,itemId:P.spu.itemId,shopId:P.spu.shopId})).done(function(a){F(P.global.useTemplate||(1===a.totalRate?I.NONE:I.NORMAL),a)}).fail(function(){F(I.ERROR,K)}),d.attr("name","head")}else F(I.NOT_LOGGED,c)}}var I={NOT_LOGGED:1,NONE:2,NORMAL:3,ERROR:4,SUPER_DEAL:5,DISABLED:6},J={ICON:"ICON",POPUP:"POPUP"},K=new b.api.spu.ResponseData({
userRank:b.api.spu.UserRank.DEFAULT,totalRate:1,sections:[{id:"spuBasePoint",name:"\u30d9\u30fc\u30b9\u30dd\u30a4\u30f3\u30c8\u5408\u8a08",totalRate:1,services:[{id:"normal",name:"\u901a\u5e38\u8cfc\u5165\u5206",rate:"1",qualified:!0},{id:"rakutenCard",name:"\u697d\u5929\u30ab\u30fc\u30c9\u3054\u5229\u7528",rate:"3",qualified:!1},{id:"mobileApp",name:"\u30a2\u30d7\u30ea\u304b\u3089\u5f53\u67081\u56de\u4ee5\u4e0a\u3054\u8cfc\u5165",rate:"1",qualified:!1},{id:"rakutenPremiumCard",name:"\u697d\u5929\u30d7\u30ec\u30df\u30a2\u30e0\u30ab\u30fc\u30c9\u30fb\u697d\u5929\u30b4\u30fc\u30eb\u30c9\u30ab\u30fc\u30c9\u3054\u5229\u7528",
rate:"1",qualified:!1,link:"//ad2.trafficgate.net/t/r/9062/1441/99636_99636/"},{id:"rakutenMobile",name:"\u697d\u5929\u30e2\u30d0\u30a4\u30eb\u3054\u52a0\u5165",rate:"1",qualified:!1}]}]}),L={normal:"BASE",rakutenmobile:"MB",rakutencard:"CB",rakutenpremiumcard:"CBP",mobileapp:"APP",superdeal:"SD",dpg:"DPG",henbai:"HEN",kaimawari:"KAI",shoppoint:"SHOP",itempoint:"ITEM",rakutenkobo:"KOBO",toolbar:"TBAR",kinken:"KINKEN",eagles:"EAGLES",rakutenbooks:"BOOKS",fcb:"FCB",warriors:"WARRIORS"},M=function(){
var a,c=[];for(a in L)c[b.enums.PointType[L[a]]]=a;return c}(),N={config:{settingsContainer:".spux-settings",settingsGlobal:".spux-settings-global",settingsCss:".spux-settings-css",settingsSc:".spux-settings-sc",settingsRat:".spux-settings-rat",settingsSpu:".spux-settings-spu",settingsPopup:".spux-settings-popup",settingsSlideshow:".spux-settings-slideshow",settingsDisplay:".spux-settings-display",templateIconData:".spux-template-icon-data",templatePopupData:".spux-template-popup-data"},global:{enabled:[!0,"bool"],
waitDom:[!1,"bool"],useTemplate:[void 0,"enumValue",I],sectionNameMaxLength:[64,"int"],serviceNameMaxLength:[64,"int"],disabledSections:["","str"],disabledServices:["","str"],orderSections:["","str"],orderServices:["","str"],userLogged:[void 0,"bool"],showEmptySections:[!1,"bool"],showEmptyServices:[!1,"bool"],componentData:["spux","str"],componentEvent:["spux-data-ready","str"],globalReplacement:["{{%}}","str"],overrideData:[void 0,"json"],sectionNames:["","str"],serviceNames:["","str"],extraRate:["","str"],
userRankRate:["","str"],userRank:[void 0,"enumValue",b.enums.UserRank],booksShopIds:[void 0,"str"]},css:{sEventElem:[".spux-icon-container,.spux-popup-container","str"],sIcon:[".spux-icon-container","str"],sPopup:[".spux-popup-container","str"],sPopupTrigger:[void 0,"str"],sPopupServices:[".spux .spux-popup-container .spux-services","str"],sPopupServiceContainer:[".spux-service-container","str"],sPopupServicesIndex:[".spux-index-services","str"],sPopupServicesIndexItem:[".spux-index-service","str"],
sPopupCloseButton:[".spux-popup-close-button","str"],sCase1:[".spux-case-one","str"],sCaseN:[".spux-case-n","str"],sCaseError:[".spux-case-error","str"],sCaseSuperdeal:[".spux-case-superdeal","str"],sCaseNologin:[".spux-case-nologin","str"],sCaseDisabled:[".spux-case-disabled","str"],sTotalRate:[".spux-total-rate","str"],cTemplateSection:["spux-section-template","str"],cTemplateSectionsPlaceholders:["spux-sections-placeholder-template","str"],cTemplateService:["spux-service-template","str"],sServiceLink:[".spux-service-link-icon","str"],
sSectionToggler:[".spux-section-header .spux-popup-arrow","str"],cTogglerHidden:["toggler-hidden","str"],sTrackingClick:[".spux-icon-container","str"],cReady:["spux-ready","str"],cTotalRate:["spux-totalrate-#TOTAL_RATE#"],cUserRank:["spux-user-rank-#USER_RANK#","str"],cQualifiesService:["spux-user-qualifies-#SERVICE_ID#","str"],cPopupDisplay:["popup-show","str"],cServiceId:["spux-service-id-#SERVICE_ID#","str"],cServiceQualifies:["spux-service-qualifies","str"],cServiceNew:["spux-service-new","str"],
cServiceActive:["spux-service-active","str"]},sc:{enabled:[!0,"bool"],addTrackingLink:[!0,"bool"],sid:["","str"],lid:["","str"],l2id:["","str"],sendDataEnabled:[!0,"bool"],sendDataProp:["prop16","str"],sendDataFormat:["spux_data:#VIEWTYPE#:#SOURCE#:#CASE#:#TOTALRATE#:#SERVICES#","str"],sendShowEnabled:[!0,"bool"],sendShowOn:[void 0,"str"],sendShowProp:["prop18","str"],sendShowFormat:["spux_show:#VIEWTYPE#:#SOURCE#:#CASE#:#TOTALRATE#:#SERVICES#","str"],includeUnusedSections:[!1,"bool"],includeUnusedServices:[!1,"bool"],
formatSection:["#SECTION_ID#-#SECTION_TOTALRATE#","str"],formatSectionSeparator:[";","str"],formatService:["#SERVICE_ID#-#SERVICE_RATE#","str"],formatServiceSeparator:[";","str"]},rat:{enabled:[!0,"bool"],accountId:[459,"int"],serviceId:[1,"int"],sendDataEnabled:[!0,"bool"],sendDataCaseName:["spux_data:#VIEWTYPE#:#SOURCE#:#CASE#","str"],sendShowEnabled:[!0,"bool"],sendShowOn:[void 0,"str"],sendShowCaseName:["spux_show:#VIEWTYPE#:#SOURCE#:#CASE#","str"],includeUnusedSections:[!0,"bool"],includeUnusedServices:[!1,"bool"]
},spu:{enabled:[!0,"bool"],sid:[void 0,"enumValue",b.api.spu.ServiceId],source:[void 0,"enumValue",b.api.spu.Source],viewType:[void 0,"enumValue",b.api.spu.ViewType],userRank:[void 0,"enumValue",b.api.spu.UserRank],itemId:[void 0,"str"],shopId:[void 0,"str"],encoding:[b.api.spu.Encoding.EUC_JP,"enumValue",b.api.spu.Encoding],defaultOnNotLogged:[!0,"bool"]},popup:{enableOn:["NORMAL","str"],viewWidth:[void 0,"str"],displayOn:[b.browser.isMobile?"click":"hover","str"],showDelay:[0,"int"],hideDelay:[0,"int"],
checkDelay:[300,"int"],toggleType:["toggle","str"],toggleShow:["all","str"]},slideshow:{enabled:[!1,"bool"],pagination:[!1,"bool"],scrollMode:["SIMPLE","str"]},display:{enabled:[!0,"bool"],onError:[!1,"bool"],waitDom:[!1,"bool"],parent:["body","str"],template:["#NZ_POINTS#","str"],templateNzPoints:['(<div class="popover-container"><span class="point-line">#ITEM_POINTS_FORMATTED#\u30dd\u30a4\u30f3\u30c8(\u5186\u76f8\u5f53)#NZ_SUPER_DEAL#<i class="arrow"></i></span><span class="rate-line"></span></div>)',"str"],
templateNzRate:["#TOTAL_RATE#\u500d\u4ee5\u4e0a","str"],templateNzSuperDeal:[", #SUPER_DEAL_PERCENT#%\u30dd\u30a4\u30f3\u30c8\u30d0\u30c3\u30af","str"],templateItem:['<li class="entry service-#SERVICE_ID#"><div class="label">#SERVICE_NAME#</div><div class="rate"><span class="sign">+</span><span>#SERVICE_RATE#</span>\u500d</div><div class="value"><span>#SERVICE_POINTS#</span>\u30dd\u30a4\u30f3\u30c8</div></li>',"str"],dataPrice:["price","str"],dataExtraRate:["extraRate","str"],dataHenbai:["henbai","str"],
dataUserRankRate:["userRankRate","str"],dataShopId:["shopId","str"],dataGenreId:["genreId","str"],dataItemType:["itemType","str"],dataAccept:["accept","str"],dataIgnore:["ignore","str"],dataWhitePoints:["whitePoints","str"],dataBlackPoints:["blackPoints","str"],dataWhiteRates:["whiteRates","str"],dataBlackRates:["blackRates","str"],sDisplayElements:[".spux-display-formatted","str"],cDisplayedElements:["spux-display-formatted-ready","str"],breakDownOrder:["normal:-999,itemPoint:900,shopPoint:910,superDeal:920,kaimawari:930","str"],
minPrice:["","str"],popupServicesIndexItemSize:[67,"int"]}},O={},P=function(){var a,c,f,i=b.getNextElement(N.config.settingsContainer);return 0===i.length?null:(O.settings=i,a={},a.global=b.readSettings(i.find(N.config.settingsGlobal),N.global),a.css=b.readSettings(i.find(N.config.settingsCss),N.css),a.sc=b.readSettings(i.find(N.config.settingsSc),N.sc),a.rat=b.readSettings(i.find(N.config.settingsRat),N.rat),a.spu=b.readApiSettings(i.find(N.config.settingsSpu),N.spu),a.popup=b.readSettings(i.find(N.config.settingsPopup),N.popup),
a.slideshow=b.readSettings(i.find(N.config.settingsSlideshow),N.slideshow),a.display=b.readSettings(i.find(N.config.settingsDisplay),N.display),void 0===a.sc.sendShowOn&&(a.sc.sendShowOn=a.popup.enableOn),void 0===a.rat.sendShowOn&&(a.rat.sendShowOn=a.popup.enableOn),a.global.booksShopIds&&(a.global.booksShopIds=function(a){for(a=a.replace(/\s/g,"").split(","),c=0,f=a.length;f>c;c++)a[c]=parseInt(a[c],10);return a}(a.global.booksShopIds)),a.global.sectionNames=e(a.global.sectionNames),a.global.serviceNames=e(a.global.serviceNames),
a.global.extraRate=g(a.global.extraRate),a.global.disabledSections=d(a.global.disabledSections,","),a.global.disabledServices=d(a.global.disabledServices,","),a.global.userRankRate=h(a.global.userRankRate),a.display.minPrice=k(a.display.minPrice),a)}(),Q={def:a.Deferred(),popupSlideshow:void 0,popupServices:{},popupActiveServiceIndex:void 0};b.browser.isSupported("2016-10-12")&&(P.global.enabled||(P.global.useTemplate=I.DISABLED,P.sc.enabled=!1,P.rat.enabled=!1,P.spu.enabled=!1),P.global.waitDom?a(H):H());
});
//# sourceMappingURL=spux-1.5.1.min.js.map