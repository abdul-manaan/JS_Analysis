/*
 suggest.js multi-1.0.4
 Copyright (c) 2015 Rakuten.Inc
 Date : 2015-11-17 21:37:21
 suggest - base.js multi-1.0.4
 Copyright (c) 2015 Rakuten.Inc
 Date : 2015-11-17 21:37:21
*/
(function(){if("undefined"!==typeof jQuery){var d=jQuery.noConflict(),f,j,i;if((f=d.find("script"))&&0!=f.length)if((i=f[f.length-1].src)&&0!=i.length)if(j=d(f[f.length-1]).attr("data")){f="suggest_"+j;window.searchplat||(window.searchplat={});window.searchplat[f]||(window.searchplat[f]={});window.searchplat.suggestTargets||(window.searchplat.suggestTargets={});window.searchplat.suggestTargets[i]||(window.searchplat.suggestTargets[i]=[]);window.searchplat.suggestTargets[i].push(j);j=function(){};
j.prototype={pluginArray:[],add:function(a){this.pluginArray.push(a)},invokeFunction:function(a,b){for(var h=0,c=this.pluginArray.length;h<c;h++){var e=this.pluginArray[h];"function"===typeof e[b]&&e[b].call(e,a,b)}},init:function(a){for(var b=0,h=this.pluginArray.length;b<h;b++){var c=this.pluginArray[b];if("function"===typeof c.init&&!c.init(a))return!1}return!0},createSuggestElems:function(a){for(var b="",h,c=0,e=this.pluginArray.length;c<e;c++)h=this.pluginArray[c],"function"===typeof h.createSuggestElems&&
(b+=h.createSuggestElems(a));return b},getSelectedText:function(a,b){for(var h=0,c=this.pluginArray.length;h<c;h++){var e=this.pluginArray[h];if("function"===typeof e.getSelectedText&&(e=e.getSelectedText(a,b)))return e}return d(b).text()},addSettingPreButtonClick:function(){for(var a=0,b=this.pluginArray.length;a<b;a++){var h=this.pluginArray[a];"function"===typeof h.addSettingPreButtonClick&&h.addSettingPreButtonClick()}},addSubmitLog:function(a){for(var b="",h=0,c=this.pluginArray.length;h<c;h++){var e=
this.pluginArray[h];"function"===typeof e.addSubmitLog&&(b+=e.addSubmitLog(a))}return b}};searchplat[f].plugins=new j;var c=function(a){this.target_id=a};c.prototype={sggstClz:"fsuggest",spaceRegExp:RegExp("^[\\s"+unescape(String.fromCharCode("0x3000"))+unescape(String.fromCharCode("0x00A0"))+"]+"),whitespaceMatcher:RegExp("[\\s"+unescape(String.fromCharCode("0x3000"))+unescape(String.fromCharCode("0x00A0"))+"]+"),blackList:["iphone","ipod","ipad","android"],onOffBlackList:[],configCollection:"col",
cssRow:"sggstRow",cssSelect:"sggstSelect",cssNoSelect:"sggstNoselect",cssKeyword:"sggstKeyword",cssOnoff:"sggstOnoff",cssOffImage:"sggstHideimg",cssOnImage:"sggstOpenimg",cssRemarks:"sggstComment",cssRemarksBox:"sggstCommentbox",cssComment:"sggstBetabtn01",cssOff:"sggstBetabtn02",cssOn:"openSuggest",cssLastKeywordRow:"sggstRowLast",cssLastAreaRow:"sggstAreaLast",searchCommand:"suggest",submitLogCommand:"submit",cookieCommand:"conf",paramInput:"q",paramCollection:"cl",paramSuggestid:"sid",paramSuggestUse:"su",
paramSelectNum:"sn",paramSuggestOnOff:"so",paramFormParam:"fp",paramReqid:"rid",sggstReqid:Math.floor(1E10*Math.random()),paramEncoding:"oe",paramSelect:"ss",paramGroupId:"gi",paramCookieMethod:"mt",paramCookieCheck:"c",paramCookieAdd:"a",paramCookieDelete:"d",paramSubmitWay:"sw",paramCallback:"cb",paramExParam:"ex",ajaxSearchTimeout:1E4,ajaxSubmitLogTimeout:3E3,afterWaitingforEventTimeout:100,justAddedToQueueTimeout:10,pollingTime:10,retryCount:20,browser:{},sggstConfigExt:"#sggstConfigExt",sggstConfigExtValues:"configValues",
init:function(a){var b=this,h=b.config=d("#"+a),c=window.searchplat["suggest_"+a],e=c.hook,k=c.rsuggest,f=c.plugins;b.initialize(a);b.setExtValueToConfig(k,a);if(!b.validateConfig(h))return!1;b.getConfigValue(b);"input"==b.suggestPos&&(b.suggestDivPos=k.input.parent());if(!b.preInit()||1!=b.input.parent(".sggstInputWrap").length){try{b.initFailure()}catch(i){}return!1}if("undefined"!==typeof e&&void 0!=e.prototype&&(d.extend(c.rsuggest,e.prototype),!b.preHookInit())){try{b.initFailure()}catch(j){}return!1}if(-1==
b.judge()){try{b.initFailure()}catch(m){}return!1}if(!f.init(b)){try{b.initFailure()}catch(n){}return!1}b.preHookCreateDiv();b.createSuggestDiv();b.onoffReady();b.resize();d(window).resize(function(){b.resize()});b.input.keydown(function(a){b.enterFlag=0;b.keyCode=a.keyCode;switch(a.keyCode){case 40:b.down();break;case 38:b.up();break;case 9:b.hide()}}).keypress(function(a){b.keyCode=a.keyCode;b.enterFlag=1;switch(a.keyCode){case 27:return 27==b.keyCode&&b.hide(!0),!1;case 13:return 13==b.keyCode&&
(1==b.enterFlag&&1==b.clickEnableFlag)&&(b.clickEnableFlag=0,b.decisionFlag=1,b.submitWay=1,setTimeout(function(){b.buttonClick()},10),b.eventStop()),!1}}).keyup(function(a){switch(a.keyCode){case 27:return 27==b.keyCode&&b.hide(!0),!1;case 13:return 13==b.keyCode&&(1==b.enterFlag&&1==b.clickEnableFlag)&&(b.clickEnableFlag=0,b.decisionFlag=1,b.submitWay=1,setTimeout(function(){b.buttonClick()},10),b.eventStop()),!1}}).focus(function(){b.lastInput=b.input.val();0==b.mouseOver&&(b.backup=b.input.val());
b.eventStart()}).blur(function(){0==b.mouseState&&0==b.mouseOver?b.eventStop():(1==b.mouseState||1==b.mouseOver)&&b.input.focus();b.mouseState=0}).mouseover(function(){1==b.keywordReplaceOnMouseover&&(b.suggest.is(":visible")&&-1!=b.index&&0!=b.backup.length&&b.lastInput==b.input.val())&&(b.input.val(b.backup),b.sggstSelectNum=-1,b.usingChar="")}).attr("maxlength",2048);document.activeElement.id==b.input.attr("id")&&(b.input.blur(),b.input.focus());f.invokeFunction(b,"postInit");b.postInit();b.postHookInit();
return!0},preInit:function(){return!0},preHookInit:function(){return!0},preHookCreateDiv:function(){},postInit:function(){return!0},postHookInit:function(){return!0},getConfigValue:function(a){var b=a.config;a.form=d("#"+b.attr("form"));a.baseUrl=b.attr("baseUrl");a.button=d("#"+b.attr("button"));a.suggestId=b.attr("suggestId");a.encoding=b.attr("encoding");a.exParam=b.attr("exParam")||"";a.groupId=b.attr("groupId");a.input=d("#"+b.attr("input"));a.input.attr("autocomplete","off");a.suggestPos=b.attr("suggestpos")||
"";a.sendFormParam=a.checkBoolNum(b.attr("sendFormParam"))||1;a.onoffEnable=a.checkBoolNum(b.attr("onoff"))||1;a.keywordReplaceOnMouseover=a.checkBoolNum(b.attr("keywordReplaceOnMouseover"))||0;a.addBlackList=b.attr("uaBlackList")||"";a.byteNumToHideOpenSggst=b.attr("byteNumToHideOpenSggst")||36;a.nowFontSize=d("html").css("font-size");a.hideToolTips=b.attr("hideToolTips")||"";a.openToolTips=b.attr("openToolTips")||"";a.pollingTime=b.attr("pollingTime")||a.pollingTime;a.retryCount=b.attr("retryCount")||
a.retryCount},setExtValueToConfig:function(a,b){d(a.sggstConfigExt).children("."+b).filter(function(){if(d(this).attr(a.sggstConfigExtValues))for(var b=d(this).attr(a.sggstConfigExtValues).split(","),c=0,e=b.length;c<e;c++){var k=b[c].split(":::"),f=k[0],i="";f&&!a.isMatch(f,"^(id|class|style)$/")&&(2==k.length&&(i=k[1].replace(/;;;/g,",")),a.config.attr(f,i))}b=d(this).get(0);c=0;for(e=b.attributes.length;c<e;c++)b.attributes[c].name.match("data-config-")&&(k=b.attributes[c].name.replace("data-config-",
""))&&a.config.attr(k,b.attributes[c].value)})},initialize:function(a){this.resultCache={};this.suggestName="suggest_"+a;this.lastInput=this.backup="";this.respInput=null;this.sggstSelectNum=-1;this.usingChar="";this.mouseInput=null;this.mouseOver=this.mouseMove=this.mouseState=0;this.enterFlag=1;this.currentFontSize=this.keyCode=null;this.maxIndex=0;this.index=-1;this.clickEnableFlag=1;this.IeVersion=0;this.waitTimeout=this.showTimer=this.viewEvent=null;this.suggestDivPos=d("body");this.onoff=1;
this.onoffInitFlag=0;this.offElem=this.onElem=null;this.submitWay=this.scVal=this.decisionFlag=0;this.isTimeout=!1;this.readyState=0},validateConfig:function(a){if(void 0==a||!this.isMatch(a.attr("input"),/^[a-zA-Z0-9_\-]+$/)||!this.isMatch(a.attr("form"),/^[a-zA-Z0-9_\-]+$/)||!this.isMatch(a.attr("baseUrl"),/^https?:\/\/.+$/)||!this.isMatch(a.attr("button"),/^[a-zA-Z0-9_\-]+$/)||!this.isMatch(a.attr("suggestId"),/^[a-zA-Z0-9_\-]+$/)||!this.isMatch(a.attr("encoding"),/^(utf-8|euc-jp)$/)||!this.isMatch(a.attr("col"),
/^[a-z]+$/)||!this.isMatch(a.attr("groupId"),/^[a-zA-Z0-9_\-]+$/))return!1;var b=a.attr("byteNumToHideOpenSggst");return b&&!this.isInRange(b,1,99)||(b=a.attr("openToolTips"))&&!this.isMatch(b,/^[^<>]+$/)||(b=a.attr("hideToolTips"))&&!this.isMatch(b,/^[^<>]+$/)||(b=a.attr("uaBlackList"))&&!this.isMatch(b,/^[a-zA-Z0-9 _\/\.,;]+$/)||(b=a.attr("exParam"))&&!this.isMatch(b,/^[^<>]+$/)||(b=a.attr("pollingTime"))&&!this.isInRange(b,10,1E3)||(b=a.attr("retryCount"))&&!this.isInRange(b,1,100)||(b=a.attr("onoff"))&&
!this.isInRange(b,0,1)||(b=a.attr("sendFormParam"))&&!this.isInRange(b,0,1)?!1:(a=a.attr("keywordReplaceOnMouseover"))&&!this.isInRange(a,0,1)?!1:!0},checkBoolNum:function(a){return"undefined"!=typeof a&&0!=a.length&&(0==a||1==a)?a:""},escapeHtml:function(a){return d("<div/>").text(a).html()},initFailure:function(){this.input.attr("autocomplete","")},createSuggestDiv:function(){var a=this,b=searchplat[a.suggestName].plugins,c=searchplat[a.suggestName].rsuggest;a.suggest=d("<div>").attr("id",a.target_id).addClass(c.sggstClz).addClass("clearFix").show().hide().appendTo(a.suggestDivPos);
c=b.createSuggestElems(this);a.suggest.append(c);a.suggest.delegate("."+a.cssKeyword,"mouseup",function(c){var h=d(this),k=h.text();1!=c.which||(a.mouseInput!=k||0==a.clickEnableFlag)||(a.mouseState=2,a.input.blur(),c=b.getSelectedText(a,h.parent("."+a.cssRow)),a.input.val(c),a.sggstSelectNum=a.index,a.usingChar=k,a.clickEnableFlag=0,a.decisionFlag=1,a.submitWay=2,setTimeout(function(){a.buttonClick()},10),a.eventStop())});a.suggest.delegate("."+a.cssKeyword,"mousedown",function(b){if(1!=b.which)a.input.blur();
else return a.mouseInput=d(this).text(),a.mouseState=1,!1});a.suggest.delegate("."+a.cssKeyword,"mouseover",function(){a.over(d(this).text())});a.suggest.delegate("."+a.cssKeyword,"mouseout",function(){d(this).parent().removeClass(a.cssSelect).addClass(a.cssNoSelect);a.mouseState=0;a.mouseInput=null});a.suggest.delegate("."+a.cssKeyword,"mousemove",function(){a.mouseMove=1});a.remarks=d('<div class="'+a.cssRemarks+'"><div class="'+a.cssRemarksBox+' clearFix"><div class="'+a.cssComment+'">')},preSearch:function(){return!0},
search:function(){var a=this,b=a.input.val(),c;a.preSearch()&&0!=a.onoffInitFlag&&(!b||a.isMatch(b,a.spaceRegExp)?(a.usingChar="",a.sggstSelectNum=-1,a.hide()):b!=a.lastInput&&(a.lastInput=b,a.backup=b,a.readyState=0,clearTimeout(a.waitTimeout),clearInterval(a.showTimer),clearTimeout(c),c=setTimeout(function(){a.index=-1;a.mouseMove=0;a.maxIndex=0;searchplat[a.suggestName].plugins.invokeFunction(a,"search");a.waitTimeout=setTimeout(function(){clearInterval(a.showTimer)},a.pollingTime*a.retryCount);
clearInterval(a.showTimer);a.showTimer=setInterval(function(){2>a.readyState||(a.suggest.append(a.remarks),clearTimeout(a.waitTimeout),clearInterval(a.showTimer),3>a.readyState?setTimeout(function(){a.showInternal()},a.pollingTime):a.showInternal())},a.pollingTime)},a.justAddedToQueueTimeout),a.postSearch()))},showInternal:function(){this.mouseMove=1;var a=this.suggest.children().not(this.remarks).filter(function(){return"none"!==d(this).css("display")}),b=this.suggest.children();b&&b.children()&&
(b.children().hasClass(this.cssLastKeywordRow)&&b.children().removeClass(this.cssLastKeywordRow),b.children().hasClass(this.cssLastAreaRow)&&b.children().removeClass(this.cssLastAreaRow));1==this.onoff&&0<a.size()?(a=d(a[a.length-1]).children("."+this.cssKeyword),a.addClass(this.cssLastKeywordRow),a.addClass(this.cssLastAreaRow),this.suggest.show(),this.postShow()):this.suggest.hide()},postSearch:function(){},read:function(a,b){var c=this,g=setTimeout(function(){c.isTimeout=!0},c.ajaxSearchTimeout);
c.isTimeout=!1;try{d.ajax({url:a,cache:!0,timeout:c.ajaxSearchTimeout,dataType:"jsonp",scriptCharset:c.encoding,jsonp:c.paramCallback,success:function(a){clearTimeout(g);if(!c.isTimeout){var e={query:c.getParsedUrlInfo(this.url,c)};a.qInfo=e;b(a)}},error:function(){}})}catch(e){clearTimeout(c.waitTimeout),clearInterval(c.showTimer)}},getParsedUrlInfo:function(a,b){if(!a)return null;var c=document.createElement("a");c.href=a;for(var g={},c=c.search.replace("?","").split("&"),e=0,d=c.length;e<d;e++){var f=
c[e].split("=");try{g[f[0]]=2==f.length?decodeURIComponent(f[1]):""}catch(i){g[f[0]]=b.lastInput}}return g},eventStart:function(){var a=this;clearInterval(a.viewEvent);a.clickEnableFlag=!0;a.decisionFlag=!1;a.viewEvent=setInterval(function(){a.nowFontSize=d("html").css("font-size");a.currentFontSize!=a.nowFontSize&&(a.currentFontSize=a.nowFontSize,a.resize());a.controlOnElem();a.search()},100)},eventStop:function(){var a=this;clearInterval(this.viewEvent);setTimeout(function(){a.hide()},200)},postShow:function(){},
hide:function(a){a&&0!=this.lastInput.length&&(this.input.val(this.backup),this.sggstSelectNum=-1,this.usingChar="");this.lastInput=this.input.val();this.suggest.hide()},select:function(a){var b=this.suggest.children("."+this.cssSelect+", ."+this.cssNoSelect);b.filter("."+this.cssSelect).removeClass(this.cssSelect).addClass(this.cssNoSelect);b=b.filter(":visible").eq(this.index);-1!=this.index&&b.removeClass(this.cssNoSelect).addClass(this.cssSelect);a&&(a="",-1>=this.index||this.index>=this.maxIndex?
(a=this.backup,this.usingChar="",this.sggstSelectNum=-1):(this.usingChar=a=searchplat[this.suggestName].plugins.getSelectedText(this,b),this.sggstSelectNum=this.index),this.input.val(a),this.lastInput=a)},up:function(){0==this.maxIndex||(0==this.lastInput.length||0==this.config.attr(this.configCollection).length)||(-1>=this.index&&(this.index=this.maxIndex),this.suggest.is(":visible")?(this.index--,this.select(1)):this.respInput==this.lastInput&&1==this.onoff&&(this.select(),this.suggest.show()))},
down:function(){0==this.maxIndex||(0==this.lastInput.length||0==this.config.attr(this.configCollection).length)||(this.index>=this.maxIndex&&(this.index=-1),this.suggest.is(":visible")?(this.index++,this.select(1)):this.respInput==this.lastInput&&1==this.onoff&&(this.select(),this.suggest.show()))},over:function(a){var b=this,c=-1,g=b.suggest.children("."+b.cssSelect+", ."+b.cssNoSelect);g.filter("."+b.cssSelect).removeClass(b.cssSelect).addClass(b.cssNoSelect);g.filter(":visible").each(function(b,
g){if(a==d(g).text())return c=b,!1});if(g=1==b.keywordReplaceOnMouseover&&1==b.mouseMove)b.mouseOver=1,b.input.blur(),b.input.focus();b.index=c;b.select(g);setTimeout(function(){b.mouseOver=0},50)},buttonClick:function(){this.setPreButtonClick();this.setForSc();this.button.click()},setForSc:function(){this.scVal=1==this.decisionFlag?this.isUse():0;"undefined"==typeof window.searchplat.suggest&&(window.searchplat.suggest={});window.searchplat.suggest.suggestSc=d.extend(!0,{},this)},preJump:function(){return!0},
jump:function(a){this.preJump()&&this.sendSubmitLog(a)},sendSubmitLog:function(a){var b=this.config.attr(this.configCollection);if(0!=b.length){var c=this.input.val().replace(this.spaceRegExp,""),a=this.baseUrl+"/"+this.submitLogCommand+"?"+this.paramSuggestid+"="+this.suggestId+"&"+this.paramCollection+"="+b+"&"+this.paramReqid+"="+this.sggstReqid+"&"+this.paramSuggestOnOff+"="+this.onoff+"&"+this.paramSelectNum+"="+this.sggstSelectNum+"&"+this.paramSelect+"="+encodeURIComponent(this.usingChar)+
"&"+this.paramSuggestUse+"="+a+"&"+this.paramSubmitWay+"="+this.submitWay+"&"+this.paramInput+"="+encodeURIComponent(c),a=a+searchplat[this.suggestName].plugins.addSubmitLog(this);1==this.sendFormParam&&(a+="&"+this.paramFormParam+"="+encodeURIComponent(this.form.serialize()));0!=this.exParam.length&&(a+="&"+this.paramExParam+"="+encodeURIComponent(this.exParam));try{var g=this.encoding;this.config.attr(this.configCollection);var e;e=this.browser.msie?"jsonp":"json";setTimeout(function(){return!0},
this.ajaxSubmitLogTimeout);d.ajax({url:a,cache:!0,timeout:this.ajaxSubmitLogTimeout,async:!1,dataType:e,scriptCharset:g,jsonp:this.paramCallback,success:function(){}})}catch(f){}}},isUse:function(){return 0!=this.usingChar.length&&0==this.usingChar.indexOf(this.input.val())?1:0},judge:function(){for(var a=navigator.userAgent.toLowerCase(),b=0;b<this.blackList.length;b++){var c=this.blackList[b];if(0!=c.length&&(c=RegExp("("+c+")"),null!=c.exec(a)))return-1}if(0!=this.addBlackList.length)for(var g=
this.addBlackList.split(","),b=0;b<g.length;b++)if(c=g[b],0!=c.length&&-1!=a.indexOf(c))return-1;this.getBrowser(navigator.userAgent);this.browser.msie&&(b=this.browser.version,5<b&&7>b?this.IeVersion=6:6<b&&8>b&&(this.IeVersion=7));6==this.IeVersion&&(this.onoffEnable=0);for(b=0;b<this.onOffBlackList.length;b++)if(c=this.onOffBlackList[b],0!=c.length&&(c=RegExp("("+c+")"),null!=c.exec(a))){this.onoffEnable=0;break}return this.IeVersion},getBrowser:function(a){var b={};a&&(a=a.toLowerCase(),a=/(chrome)[ \/]([\w.]+)/.exec(a)||
/(webkit)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||0>a.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],a[1]&&(b[a[1]]=!0,b.version=a[2]||"0"),b.chrome&&"undefined"===typeof window.chrome?b.webkit=!0:b.chrome&&"undefined"!==typeof window.chrome?b.blink=!0:b.webkit&&(b.safari=!0));this.browser=b},preResize:function(){return!0},resize:function(){var a=0,b=0,c=0,g=0,e=0;this.preResize()&&
(b=this.getTextPosition(),7==this.IeVersion&&(b=this.getIe7TextPos(b)),a=b.top,b=b.left,e=Math.ceil(this.input.outerHeight()),!this.suggestDivPos.hasClass("sggstInputWrap")&&"relative"==this.suggestDivPos.css("position")?(g=this.suggestDivPos.offset(),c=g.top,g=g.left):this.suggestDivPos.hasClass("sggstInputWrap")&&(isNaN(parseInt(this.input.css("marginTop")))||(c=-1*parseInt(this.input.css("marginTop"),10)),isNaN(parseInt(this.input.css("marginLeft")))||(g=-1*parseInt(this.input.css("marginLeft"),
10))),this.suggest.css({top:a+e-c,left:b-g}),this.changeSuggestWidth(),this.postResize())},postResize:function(){},getTextPosition:function(){return"input"==this.suggestPos?this.input.position():this.input.offset()},getIe7TextPos:function(a){var b={},c=document.body,g=c.getBoundingClientRect(),e=(g.right-g.left)/c.offsetWidth;b.top=Math.ceil(a.top/((g.bottom-g.top)/c.offsetHeight));b.left=Math.ceil(a.left/e);return b},changeSuggestWidth:function(){var a=this.input.outerWidth(),b=0,b=parseInt(this.suggest.css("border-left-width")),
c=parseInt(this.suggest.css("border-right-width"));isNaN(b)&&(b=0);isNaN(c)&&(c=0);b+=c;c=this.suggest.outerWidth()-b;a!=c&&(this.suggest.css({width:a-b}),this.suggest.find("."+this.cssKeyword).css({width:a-b}))},onoffReady:function(){1==this.onoffEnable?(this.createOnElm(),this.createOffElm(),this.checkCookie()):this.setInitOnoffNum(1)},checkCookie:function(){var a=this;d.ajax({type:"GET",url:a.baseUrl+"/"+a.cookieCommand+"?"+a.paramGroupId+"="+a.groupId+"&"+a.paramCookieMethod+"="+a.paramCookieCheck,
dataType:"jsonp",timeout:500,jsonp:a.paramCallback,success:function(b){b=b.result;if("undefined"!=typeof b&&(0==b||1==b))a.setInitOnoffNum(0==b?1:0)}});setTimeout(function(){a.setInitOnoffNum(1)},1E3)},setInitOnoffNum:function(a){1!=this.onoffInitFlag&&(this.onoff=a,this.onoffInitFlag=1,this.displayOnoff())},createOnElm:function(){var a=this;a.onElem=d("<div />").hide().attr({"class":a.cssOn,title:a.openToolTips}).click(function(){a.setOnoffNum(1);a.input.focus();setTimeout(function(){a.lastInput=
""},120)});a.input.after(a.onElem)},createOffElm:function(){var a=this;a.offElem=d("<div />").attr({"class":a.cssOff,title:a.hideToolTips}).append(d("<span />").attr("class",a.cssOffImage));a.remarks.children().append(a.offElem);a.suggest.delegate("."+a.cssOff,"mousedown",function(b){if(1!=b.which)a.input.blur();else return a.mouseState=1,a.setOnoffNum(0),a.input.blur(),!1});a.suggest.delegate("."+a.cssOff,"mouseout",function(){a.mouseState=0})},setOnoffNum:function(a){this.onoff=a;this.setCookie(a);
this.displayOnoff()},setCookie:function(a){d.ajax({type:"GET",url:this.baseUrl+"/"+this.cookieCommand+"?"+this.paramGroupId+"="+this.groupId+"&"+this.paramCookieMethod+"="+(1==a?this.paramCookieDelete:this.paramCookieAdd),dataType:"jsonp",timeout:500,jsonp:this.paramCallback,success:function(){}})},setPreButtonClick:function(){searchplat[this.suggestName].plugins.addSettingPreButtonClick()},displayOnoff:function(){1==this.onoffEnable&&(1==this.onoff?(this.onElem.hide(),this.resize(),this.input.attr("autocomplete",
"off")):(this.resize(),this.input.attr("autocomplete",""),this.controlOnElem(),this.suggest.hide()))},controlOnElem:function(){1!=this.onoffEnable||(0!=this.onoff||0==this.byteNumToHideOpenSggst)||(1==this.isByteLengthOver(this.input.val(),this.byteNumToHideOpenSggst)?this.onElem.hide():this.onElem.is(":visible")||this.onElem.show())},isSuggestUse:function(){return"undefined"!=typeof this.scVal&&1==this.scVal},isMatch:function(a,b){return a&&RegExp(b).test(a)?!0:!1},isInRange:function(a,b,c){a=parseInt(a);
return!isNaN(a)&&a>=b&&a<=c},isNotEmptyArray:function(a){return"object"===typeof a&&"function"===typeof a.pop&&0<a.length},createWordLine:function(a){if(!a||this.isMatch(a,this.spaceRegExp))return"";for(var a=this.escapeHtml(a),b=this.respInput.toLowerCase().split(this.whitespaceMatcher),c,g=0,e=b.length;g<e;g++)c=this.escapeHtml(b[g]),a=a.replace(RegExp("(^|\\s)("+this.escapeRegExp(c)+")"),"$1<strong>$2</strong>");return a},escapeRegExp:function(a){return a.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},
isByteLengthOver:function(a,b){if(void 0===a)return 0;var c=0,g="",e=a.length,d;for(d=0;d<e;d++)if(g=escape(a.charAt(d)),c+=4>g.length&&!/%[0|1|8-9|A-F]\w|%7F/.test(g)?1:2,c>b)return 1;return 0}};d(function(){var a=window.searchplat.suggestTargets;if(a[i]&&!a[i].lock){window.searchplat.suggestTargets[i].lock=!0;for(var b=0,h=a[i].length;b<h;b++){var g=a[i][b],e="suggest_"+g;window.searchplat[e].rsuggest||(window.searchplat[e].rsuggest=new c(e));var f=window.searchplat[e].rsuggest;(!d("#"+e)||!d("#"+
e).html())&&f.init(g)}}})}}})();
(function(){if("undefined"!==typeof jQuery){var d=jQuery.noConflict(),f;if((f=d.find("script"))&&0!=f.length)if(f=d(f[f.length-1]).attr("data"))if(f="suggest_"+f,!("undefined"===typeof searchplat||"undefined"===typeof searchplat[f]||"undefined"===typeof searchplat[f].plugins)){var j=function(c){this.target_id=c};j.prototype={baseCache:null,paramSortLogic:"sl",gbQuery:"",maxRows:0,validateConfig:function(c){var a=c.config;return void 0==a?!1:(a=a.attr("maxRows"))&&!c.isInRange(a,1,30)?!1:!0},getConfigValue:function(c,
a){var b=null;c.isMatch(c.config.attr("genreBoostQuery"),/^[a-zA-Z0-9_\-]+$/)&&(b=c.config.attr("genreBoostQuery"));a.gbQuery=b||a.gbQuery;a.maxRows=c.config.attr("maxRows")||a.maxRows;return a},init:function(c){var a=c.config.attr(c.configCollection);if(!this.validateConfig(c))return!1;this.getConfigValue(c,this);this.baseCache=c.resultCache[c.suggestName+a]={};c.suggestDivInputPos=c.input.parent();if((a=c.config.attr("suggestpos"))&&"input"==a&&(!c.suggestDivInputPos||!c.suggestDivInputPos.hasClass("sggstInputWrap")))return!1;
c.button.bind("click",function(){try{c.jump(c.isUse())}catch(a){}return!0});return!0},createSuggestElems:function(c){for(var c='<div class="'+c.cssNoSelect+" "+c.cssRow+'"><span class="'+c.cssKeyword+'"></span></div>',a="",b=0,d=i.maxRows;b<d;b++)a+=c;return a},search:function(c){var a=this,b=c.lastInput;if(0===b.length)c.readyState+=2;else{var d=c.config.attr(c.configCollection),d=c.suggestName+d;c.resultCache[d]||(a.baseCache=c.resultCache[d]={});if(void 0===a.baseCache[b])try{c.read(a.createSearchUrl(c,
b),function(b){a.show(c,b)})}catch(g){c.readyState+=2}else a.show(c,a.baseCache[b])}},createSearchUrl:function(c,a){var b=c.config.attr(c.configCollection),d=c.baseUrl+"/"+c.searchCommand+"?",b=c.paramCollection+"="+b+"&"+c.paramReqid+"="+c.sggstReqid+"&"+c.paramSuggestid+"="+c.suggestId+"&"+c.paramInput+"="+encodeURIComponent(a)+"&"+this.paramSortLogic+"="+this.gbQuery+"&"+c.paramEncoding+"="+c.encoding;0!==c.exParam.length&&(b+="&"+c.exParam);if(c.exParam&&0!=c.exParam.length){for(var g=c.exParam.split("&"),
e=[],f=0,i=g.length;f<i;f++){var j=g[f].split("="),l=RegExp("(&)"+j[0]+"=[^/&]*","i");j[0]!=c.paramCollection&&j[0]!=c.paramInput&&(l.test(b)?b=b.replace(l,"&"+g[f]):e.push(g[f]))}0<e.length&&(b+="&"+e.join("&"))}return d+b},show:function(c,a){if(void 0===a.result||void 0===a.status||0!==a.status)c.suggest.children("."+c.cssRow).hide();else{var b="";a&&(a.qInfo&&a.qInfo.query&&a.qInfo.query.q)&&(b=a.qInfo.query.q);b=b?b:c.lastInput;void 0===this.baseCache[b]&&(this.baseCache[b]=a);var f=a.result.length;
0===f?c.suggest.children("."+c.cssRow).hide():(f>this.maxRows&&(f=this.maxRows),c.maxIndex+=f,c.respInput=c.lastInput,b=c.suggest.children("."+c.cssRow),b.filter("."+c.cssSelect).removeClass(c.cssSelect).addClass(c.cssNoSelect),c.suggest.show(),b.each(function(b,e){var i=d(e);if(b<f){var j=c.createWordLine(a.result[b][0]);i.show().children("."+c.cssKeyword).html(j)}else i.hide()}))}c.readyState+=2},addSubmitLog:function(){return""}};var i=window.searchplat[f].RBase=new j(f);window.searchplat[f].plugins.add(i)}}})();
