!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("wafer-scrollview",[],t):"object"==typeof exports?exports["wafer-scrollview"]=t():(e.wafer=e.wafer||{},e.wafer.wafers=e.wafer.wafers||{},e.wafer.wafers["wafer-scrollview"]=t())}("undefined"!=typeof self?self:this,function(){return function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,i){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="https://s.yimg.com/aaq/wf/",t(t.s="./src/entry.js")}({"./src/entry.js":function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),d=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},h=window.wafer,f=h.base,v=h.features,p=h.utils,y=h.WaferBaseClass,g=v.transformProperty,m=p.bindEvent,b=p.convertNodeListToArray,w=p.fetchWithCache,_=p.isVisible,E=p.throttle,k=p.unbindEvent,D=30,O="active",C=["next","prev"],j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;e.style.webkitTransition="transform "+t+"ms ease-out",e.style.transition="transform "+t+"ms ease-out"},x=function(e){e.style.webkitTransition="",e.style.transition=""},T=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.counter,a=void 0===s?0:s,o=r.syncDelay,l=void 0===o?25:o;i(this,t);var c=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,{},{})),d=e.getAttribute("data-wf-behavior"),h=parseInt(e.getAttribute("data-wf-edge-padding"))||0,v=e.getAttribute("data-wf-pagination-target"),p=e.getAttribute("data-wf-trigger-wf-during-transition");if(c._util={elem:e,triggerWafersDuringTransition:"1"===p?1:0,behavior:d,edgePadding:h},"native"===d){c._syncWithThrottle=E(function(){f.sync(e)},l,c);var y=void 0;if(b(e.children).some(function(e){return!!e.classList.contains("active")&&(y=e,!0)}),y&&0===e.scrollLeft){var g=e.getBoundingClientRect(),m=g.width,w=y.getBoundingClientRect(),_=w.width,k=w.left;e.scrollLeft=_>=m?k-D:k-(m-_)/2}return c.addEventListeners(),n(c)}var x=v&&document.body.querySelector(v)||b(e.getElementsByClassName("indicators"))[0],T=void 0,P=void 0;x&&"count"===(T=x.getAttribute("data-wf-pagination-type")||"default")&&(P=b(x.getElementsByClassName("current-page"))[0]);var X=c._util=u({},c._util,{counter:a,drag:{endX:0,endY:0,isVerticalDirection:!1,startX:0,startY:0},elem:e,indicatorCountElem:P,indicatorElem:x,indicatorType:T,nextBtn:b(e.getElementsByClassName("next-btn"))[0],prevBtn:b(e.getElementsByClassName("prev-btn"))[0],sliderElem:b(e.getElementsByClassName("slides"))[0],sliderItemsDataMapping:new Map});c._state={disableEventHandlers:!1},X.sliderItems=Array.prototype.slice.call(X.sliderElem.children),X.indicatorItems=X.indicatorElem?Array.prototype.slice.call(X.indicatorElem.children):null;var I=X.sliderItems.length;c.updateWidth(),j(X.sliderElem),X.sliderElem.style.cursor="-webkit-grab",X.sliderElem.style["padding-left"]=X.edgePadding+"px";for(var L=document.createDocumentFragment(),W=!1,A=0;A<I;A++){var B=X.sliderItems[A];B.style.width=100/I+"%",L.appendChild(B),!W&&A>0&&B.classList.contains(O)&&(a=c._util.counter=A,c.showCurrent(),W=!0)}return X.sliderElem.appendChild(L),C.forEach(function(e){c[e]=c[e].bind(c)}),c.addEventListeners(),0===a&&(c.preFetch(),c.updateSlides(a),c.updateIndicators(a),c.updateButtons()),c}return s(t,e),c(t,[{key:"slidesHasBeenUpdated",value:function(){var e=this._util;e.sliderItems=Array.prototype.slice.call(e.sliderElem.children);for(var t=e.sliderItems.length,r=0;r<t;r++){e.sliderItems[r].style.width=100/t+"%"}this.updateWidth()}},{key:"updateWidth",value:function(){var e=this._util;e.sliderElem.style.width="",e.containerWidth=e.sliderElem.getBoundingClientRect().width,e.itemWidth=e.containerWidth-2*e.edgePadding,e.sliderElem.style.width=e.itemWidth*e.sliderItems.length+"px",e.sliderElem.style[g]="translate(-"+e.counter*e.itemWidth+"px, 0)"}},{key:"addEventListeners",value:function(){var e=this._util,r=e.elem;if("native"===e.behavior)return void m(r,"scroll",this._syncWithThrottle);d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addEventListeners",this).call(this)}},{key:"removeEventListeners",value:function(){var e=this._util,r=e.elem;if("native"===e.behavior)return void k(r,"scroll",this._syncWithThrottle);d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeEventListeners",this).call(this)}},{key:"preFetch",value:function(){for(var e=this._util,t=e.counter,r=e.sliderItems,i=0;i<3;i++){var n=r[t+i],s=r[t-i];n&&this.renderSlide(n,{prefetch:!0}),s&&this.renderSlide(s,{prefetch:!0})}}},{key:"handleResize",value:function(){if("native"!==this._util.behavior){var e=this._util.sliderElem;_(e)&&(x(e),this.updateWidth(),setTimeout(function(){j(e)},0))}}},{key:"handleFetch",value:function(e){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.fetchUrl,s=i.prefetch,a=void 0!==s&&s,o=i.replace,l=void 0!==o&&o,u=i.resultSelector,c=this._util.sliderItemsDataMapping;c.has(e)||c.set(e,{});var d=c.get(e);!n||void 0!==d.fetchStatus&&2!==d.fetchStatus?(a?f.prefetch(e):f.sync(e),l&&this.slidesHasBeenUpdated()):(d.fetchStatus=0,w(n).then(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.html;if(i){var n=void 0;if(f.destroy(e),l){var s=document.createElement("div"),o=e.parentNode;s.innerHTML=i;var c=u&&s.querySelector(u);c&&(i=c.innerHTML),e.insertAdjacentHTML("beforebegin",i),o.removeChild(e),n=o}else e.innerHTML=i,n=e;d.fetchStatus=1,a?f.prefetch(e):f.sync(n),l&&r.slidesHasBeenUpdated()}}).catch(function(r){f.emitError({name:t.constructor.name,elem:e,meta:{fetchUrl:n},stack:r.stack}),d.fetchStatus=2}))}},{key:"renderSlide",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.prefetch,i=void 0!==r&&r,n=void 0,s=void 0,a=void 0,o=e.getAttribute("data-wf-url");switch(o&&(n="fetch",a=!!Number(e.getAttribute("data-wf-replace")),s=e.getAttribute("data-wf-result-selector")),n){case"fetch":this.handleFetch(e,{fetchUrl:o,prefetch:i,replace:a,resultSelector:s});break;default:i?f.prefetch(e):setTimeout(function(){f.sync(e)},250)}}},{key:"showCurrent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._util,r=t.counter,i=t.elem,n=t.itemWidth,s=t.sliderElem,a=t.sliderItems,o=r;this.isValidMove(e)&&(o=r+e)!==r&&(t.counter=o,this.renderSlide(a[o]),this.updateSlides(o,r),this.updateIndicators(o,r),this.updateButtons(),this.preFetch(),f.emitWaferEvent("scrollview:change",{elem:i,meta:{index:o+1,prevIndex:r+1}}));var l="translateX(-"+o*n+"px)";l!==this._util.transformValue&&(s.style[g]=l,this._util.transformValue=l)}},{key:"updateSlides",value:function(e,t){var r=this._util.sliderItems;r[t]&&r[t].classList.remove(O),r[e]&&r[e].classList.add(O)}},{key:"updateIndicators",value:function(e,t){var r=this._util;if("count"===r.indicatorType){var i=r.indicatorCountElem;i&&(i.innerHTML=e+1)}else{var n=r.indicatorItems;n&&(n[t]&&n[t].classList.remove(O),n[e]&&n[e].classList.add(O))}}},{key:"updateButtons",value:function(){var e=this._util,t=e.counter,r=e.nextBtn,i=e.prevBtn,n=e.sliderItems,s=n.length;r&&(t===s-1?r.setAttribute("disabled",!0):r.removeAttribute("disabled")),i&&(0===t?i.setAttribute("disabled",!0):i.removeAttribute("disabled"))}},{key:"updateAfterDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._util.drag,r=t.currentDirection,i=t.endX,n=t.horizontalDirection,s=t.startX,a=i-s,o=r===n;o&&a>0&&Math.abs(a)>30?this.showCurrent(-1,e):o&&a<0&&Math.abs(a)>30?this.showCurrent(1,e):this.showCurrent()}},{key:"isValidMove",value:function(e){var t=this._util,r=t.sliderItems,i=t.counter,n=r.length;return 1===e&&i<n-1||-1===e&&i>0||0===e}},{key:"grab",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._util.drag;this._util.pointerDown=!1,t.endX&&this.updateAfterDrag(e),this.clearDrag()}},{key:"grabbing",value:function(){var e=this._util,t=e.counter,r=e.drag,i=e.elem,n=e.itemWidth,s=e.sliderElem,a=e.triggerWafersDuringTransition,o=r.startX,l=r.endX,u=-1*(t*n+(o-l)),c="translateX("+u+"px)";a&&2*Math.abs(u)>=n&&f.sync(i),c!==this._util.transformValue&&(this._util.drag.grabbing=!0,s.style[g]=c,this._util.transformValue=c)}},{key:"clearDrag",value:function(){var e=this;this._util.drag={currentDirection:null,endX:0,endY:0,grabbing:!1,horizontalDirection:0,last:0,startX:0,startY:0},this._util.grabTimeout&&clearTimeout(this._grabTimeout),this._util.grabTimeout=setTimeout(function(){e._util.drag.isVerticalDirection=!1},50)}},{key:"next",value:function(e){e.preventDefault(),e.stopPropagation(),this.showCurrent(1,{source:"button",type:"next",sourceEvent:e})}},{key:"prev",value:function(e){e.preventDefault(),e.stopPropagation(),this.showCurrent(-1,{source:"button",type:"prev",sourceEvent:e})}},{key:"keydown",value:function(e){this._state.disableEventHandlers||(e=e||window.event,37===e.keyCode?this.showCurrent(-1,{source:"key",type:"prev"}):39===e.keyCode&&this.showCurrent(1,{source:"key",type:"next"}))}},{key:"touchstart",value:function(e){if(!this._state.disableEventHandlers){var t=this._util,r=e.touches[0],i=r.pageX,n=r.pageY;t.pointerDown=!0,t.drag.isVerticalDirection=!1,t.drag.startX=i,t.drag.startY=n}}},{key:"touchend",value:function(e){this._state.disableEventHandlers||(this._util.pointerDown=!1,this.grab({source:"touch"}))}},{key:"touchmove",value:function(e){if(!this._state.disableEventHandlers){var t=this._util,r=t.drag,i=r.startX,n=r.startY,s=e.touches[0],a=s.pageX,o=s.pageY,l=0;r.isVerticalDirection||(Math.abs(n-o)>8&&(r.isVerticalDirection=n>o?1:-1),i!==a&&(l=i>a?1:-1),r.horizontalDirection=l,r.last!==a&&(r.currentDirection=r.last>a?1:-1,r.last=a),t.pointerDown&&(r.endX=a,r.endY=o,this.isValidMove(l)&&(t.drag.grabbing&&e.preventDefault(),Math.abs(n-o)>8&&(r.isVerticalDirection=n>o?1:-1),l&&!r.isVerticalDirection&&this.grabbing())))}}},{key:"mousedown",value:function(e){if(!this._state.disableEventHandlers){e.preventDefault&&e.preventDefault();var t=this._util,r=e.pageX,i=e.pageY;t.pointerDown=!0,t.drag.isVerticalDirection=!1,t.drag.startX=r,t.drag.startY=i}}},{key:"mouseup",value:function(e){this._state.disableEventHandlers||(this._util.sliderElem.style.cursor="-webkit-grab",this.grab({source:"mouse"}))}},{key:"mouseleave",value:function(e){if(!this._state.disableEventHandlers){e.preventDefault();var t=this._util,r=t.pointerDown,i=t.drag,n=t.sliderElem;if(r){var s=e.pageX,a=e.pageY;i.endX=s,i.endY=a,n.style.cursor="-webkit-grabbing",this.grabbing()}}}},{key:"mousemove",value:function(e){if(!this._state.disableEventHandlers){var t=this._util,r=t.pointerDown,i=t.sliderElem,n=t.drag;if(r){var s=e.pageX,a=e.pageY;this._util.pointerDown=!1,i.style.cursor="-webkit-grab",n.endX=s,n.endY=a,this.updateAfterDrag(),this.clearDrag()}}}},{key:"remove",value:function(){this._util.elem.remove()}},{key:"destroy",value:function(){this.removeEventListeners(),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}}]),t}(y);T.events={click:[["next-btn","next"],["prev-btn","prev"]],keydown:[["_self","keydown"]],mousedown:[["slides","mousedown"]],mouseleave:[["slides","mouseleave"]],mousemove:[["slides","mousemove"]],mouseup:[["slides","mouseup"]],touchend:[["slides","touchend"]],touchmove:[["slides","touchmove"]],touchstart:[["slides","touchstart"]]};var P=T,X=window.wafer.controllers,I=X.WaferBaseController,L=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.root,i=void 0===r?document:r,n=e.selector,s=void 0===n?".wafer-scrollview":n;a(this,t);var l=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{root:i,selector:s,WaferClass:P}));return l.sync(),l}return l(t,e),t}(I),W=L;t.default=new W({})}})});