function trackByGraylog(e,t){var n=window.location.protocol+"//statistic.csdn.net/";$.get(n+e,t)}function getMore(e,t,n,i,o){var i=i,a=t;$.ajax({type:"get",url:"/api/articles",dataType:"json",data:{type:t,category:window.category,shown_offset:window.shownOffset,first_view:n},beforeSend:function(){null!==e&&e.length>0&&e.show(),n&&tipBox.hide(),null!==noFocusBox&&noFocusBox.remove(),newNotice.hide()},success:function(t){t.articles.length<=5&&trackByGraylog("www",{category:window.category,count:t.articles.length}),"true"!==t.status?(null!==e&&e.hide(),window.not_loading=!1,0===t.articles.length&&"watchers"===window.category?getRecommendMaster():noticeHide()):(null!==e&&e.hide(),(0!==t.shown_offset||"more"===a)&&(window.shownOffset=t.shown_offset),dataList=t.articles,i(dataList,o),noticeHide())},complete:function(){window.not_loading=!0,window.not_scroll=!0}})}function bulidEle(e,t){var n=getHtml(e,t);return n.find("a.btn-nav").on("tap",function(e){e.preventDefault(),changeNav($(this))}),n}function getNew(e,t){t&&domList.find("li:first").before(tipBox);for(var n=0;n<e.length;n++){var i=bulidEle(e[n],t);tipBox.before(i)}t&&($(".red-dot").fadeOut(4e3,function(){$(this).remove()}),getNewNoticeMsg.text("已为您更新"+e.length+"条内容"),getNewNotice.slideDown(function(){var e=$(this);setTimeout(function(){e.slideUp()},2500)})),t||setTimeout(function(){feedlistScroll()},500),tipBox.show()}function loadFirst(e){for(var t=0;t<e.length;t++){if(2===t||8===t){var n=document.createElement("li");n.setAttribute("data-type","love"),n.id="a_d_banner_"+adNum++;var i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("charset","utf-8"),i.setAttribute("data-id","dc73d38425b2e6311070c93503c50b97"),i.setAttribute("data-hide-ad-label","0"),i.setAttribute("data-nt",network_state),i.setAttribute("data-div-Style","width:100%; padding: "+parseFloat(.24*window.fontSize)+"px "+parseFloat(.32*window.fontSize)+"px "+parseFloat(.08*window.fontSize)+"px ;border-bottom: 1px solid #d8d8d8;background-image: url(//img-ads.csdn.net/2016/201608021757063065.png);background-repeat: no-repeat;background-position: 96% "+parseFloat(.32*window.fontSize)+"px;"),i.setAttribute("data-img-Style","display:none"),i.setAttribute("data-tit-Style","font-size:"+parseFloat(.34*window.fontSize)+"px; line-height:"+parseFloat(.48*window.fontSize)+"px;max-height:"+parseFloat(.96*window.fontSize)+"px;overflow: hidden;font-weight: bold;font-family: PingFang SC,Hiragino Sans GB,Arial,Microsoft YaHei,Roboto,Noto,Helvetica Neue,sans-serif;margin-left:-10px;"),i.setAttribute("data-des-Style","font-size:"+parseFloat(.24*window.fontSize)+"px; font-family: PingFang SC,Hiragino Sans GB,Arial,Microsoft YaHei,Roboto,Noto,Helvetica Neue,sans-serif;padding:0;margin:0;margin-left:-10px;line-height:"+parseFloat(.68*window.fontSize)+"px"),i.setAttribute("src","https://shared.ydstatic.com/js/yatdk/3.0.0/stream.js"),i.setAttribute("data-insert-nodes","a_d_banner_"+(adNum-2)+",a_d_banner_"+(adNum-1)),tipBox.before(n)}var o=bulidEle(e[t]);tipBox.before(o)}document.body.appendChild(i),setTimeout(function(){feedlistScroll()},500),tipBox.show(),getMore(null,"more",!1,loadMore)}function getRecommendMaster(){$.ajax({url:"/api/get_recommend_experts",type:"post",timeout:5e3,success:function(e){"true"===e.status&&bulidMasterHtml(e.data,"还木有文章出来，关注更多博主，获取更多文章吧~")},error:function(e,t){"timeout"===t?console.log("timeout"):console.log("error")}})}function bulidMasterHtml(e,t){noFocusBox=$('<div class="no-focus-box"></div>'),noFocusBox.append("<p class='notice'>"+(t?t:"您还木有关注呢，赶快起来关注吧～")+"</div><h3>推荐热门博客专家</h3>");for(var n=$('<div class="master-box clearfix"></div>'),i=function(e){var t='<div class="item-box">                  <a href="'+e.blog_url+'" target="_blank">                      <dl class="clearfix">                          <dt>                              <img src="'+e.img+'" alt="item.realName" title="'+e.realName+'">                          </dt>                          <dd>                              <p class="name">'+e.realName+'                                <svg width="14" height="14" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path fill="#F9D748" d="M6.97 0L5.7.533H4.32l-.994.994-1.297.544-.523 1.276-.974.974v1.407L0 7.03.533 8.3v1.38l.994.993.544 1.298 1.276.522.974.974h1.407L7.03 14l1.271-.533H9.68l.995-.994 1.297-.544.521-1.276.976-.974V8.272L14 6.97l-.532-1.27V4.32l-.995-.993-.544-1.298-1.275-.522-.975-.974H8.272z"/><path d="M4.09 9.063c.552-3.298 2.798-6.073 5.9-7.137l.34-.095c.176.421.37 1.032.452 1.478a6.414 6.414 0 0 1-.012 2.386l-.01.057-.048.032c-.544.45-1.555.877-2.14.855.391.1 1.099.148 1.887.105l-.062.194c-.78 1.87-2.384 3.214-4.293 3.598a5.754 5.754 0 0 1-1.025.11c-.118.33-.23.672-.335 1.025l-.061.202-2.099.84.325-.913a22.39 22.39 0 0 1 1.182-2.737z" fill="#B58F23"/><path d="M8.886 2.874l.44-.39C6.972 3.557 5.225 5.688 4.54 8.236a21.144 21.144 0 0 1 4.347-5.362zm1.071-.647a6.139 6.139 0 0 1 .324 3.357 5.436 5.436 0 0 1-2.823.866l-.155.003a14.688 14.688 0 0 1 2.163-2.25l.154-.13c.002-.518 0-.82-.007-.905l-.06-.784a8.25 8.25 0 0 1 .404-.157zM8.642 6.961c.346.052.975.065 1.185.065-.773 1.683-2.26 2.888-4.016 3.24a5.415 5.415 0 0 1-.626.089c.525-1.407 1.166-2.62 1.974-3.711.36.118.853.224 1.483.317zm.515-4.113c.019.249.027.497.027.744C6.7 5.701 4.857 8.54 3.895 11.732c-.188.078-.379.15-.574.215.938-3.617 2.996-6.824 5.836-9.1z" fill="#FFF"/></g></svg>                              </p>                              <p class="num">'+e.viewCount+'篇</p>                          </dd>                      </dl>                      <p class="tit oneline">'+e.title+'</p>                  </a>                  <button class="btn btn-default btn-xs btn-focus" data-name="'+e.userName+'">关注</button>              </div>';return t},o=0;o<e.length-1;o++)n.append(i(e[o]));noFocusBox.append(n),$("main").append(noFocusBox)}function loadMore(e){for(var t=0;t<e.length;t++){var n=bulidEle(e[t]);domList.append(n)}}function getHtml(e,t){var n='<li data-type="blog" data-id="'+e.id+'">'+(t?'<div class="red-dot"></div>':"")+'<h2 class="csdn-tracking-statistics" data-mod="popu_459" data-poputype="feed" data-feed-show="false" data-dsm="post"><a strategy="'+e.strategy_id+'" href="'+e.url+'" target="_self">'+e.title+'</a></h2>      <div class="info-tag">'+("home"===window.category&&"other"!==e.category_id?'<div class="tag after-dotted">          <a class="btn-nav" onclick="changeNav($(this))" data-href="/nav/'+e.category_id+'" data-category="'+e.category_id+'">'+e.category+"</a>        </div>":"")+'<div class="user-name after-dotted"><a>'+e.nickname+'</a></div>      <div class="read-count after-dotted">'+e.views+'阅读</div>      <div class="date">'+e.created_at+'</div>      <div class="unlike-box">        <a class="btn-unlike" data-category="'+e.category+'" onclick="unlike($(this))">          <svg role="img" class="icon-close">            <use xmlns: xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-close"></use>            </svg>          </a>        </div>      </div>    </li>';return $(n)}function readTimer(e){function t(e){if(e>0){if(e<60)i.container.text(e+"分钟前阅读到这里，点击刷新");else if(e>=60&&e<120)i.container.text("1小时前阅读到这里，点击刷新");else if(e>=120)return i.container.text("2小时前阅读到这里，点击刷新"),void clearInterval(i.setTimeShow)}else i.container.text("刚刚阅读到这里，点击刷新")}function n(){i.setTimeShow=setInterval(function(){i.curTime+=1,t(i.curTime)},6e4)}if(arguments.callee.readTimer)return arguments.callee.readTimer;arguments.callee.readTimer=this;var i=this;return i.setTimeShow=null,i.container=$(".btn-loadnew"),i.curTime=0,i.setReadTime=function(e){clearInterval(i.setTimeShow);var o,a,r;o=new Date,a=o.getHours(),r=o.getMinutes(),i.curTime=e?e:0,t(i.curTime),n()},void 0!==e&&t(e),n(),this}function swipershow(){"home"===window.category?null===myswiper?myswiper=new mswiper({data:carouselList}):myswiper.show():null!==myswiper&&myswiper.hide()}function activeNav(){var e=navList.removeClass("active").filter('[data-category="'+window.category+'"]').addClass("active");$("div.nav-mask").scrollLeft(e.position().left-20)}function changeNav(e){if(e.data("normalhref"))return window.location.href=e.attr("href"),!0;domList.find("li:not(.tip_box)").remove(),$("body").find(">iframe").remove(),$("div.no-focus-box").remove(),window.category=e.data("category"),$("main").attr("data-category",e.data("category")),"watchers"===window.category&&""===window.currentUser&&(location.href="https://passport.csdn.net/account/login"),0===e.parents("nav").length?activeNav():e.addClass("active").siblings(".active").removeClass("active");var t="home"===window.category?"CSDN-专业IT技术社区":e.text()+"-CSDN";getMore($(".feed_loading"),"new",!0,loadFirst);var n=location.origin+e.data("href");window.history.pushState(null,t,n),document.title=t,swipershow()}function noticeHide(){newNotice.hide(),setTimeout(function(){newNotice.show()},6e4)}function refresh(){noticeHide(),getMore($("div.feed-loading-box"),"new",!1,getNew,!0),$("body, html").animate({scrollTop:domList.offset().top-35},200,"linear"),myReadTimer.setReadTime(0)}function unlike(e){var t=e.parents("li"),n=e.data("category");unlikeBox.find("span.category").text(n),unlikeBox.find("a.btn-unlike").one("click",function(n){n.preventDefault(),e.trigger("click"),unlikeBox.hide(),t.slideUp("slow",function(){e.remove()}),$(this).trigger("click")}),unlikeBox.show()}function guanzhu(e){e.attr("disabled",!0);var t="https://my.csdn.net/index.php/follow/do_follow?jsonpcallback=?";$.getJSON(t,{username:e.data("name")},function(t){1==t.succ?e.addClass("followed").text("已关注"):"已关注"===t.msg?e.addClass("followed").text("已关注"):e.removeAttr("disabled")})}var network_state="4G",ua=window.navigator.userAgent,con=window.navigator.connection;if(/MicroMessenger/.test(ua))if(/NetType/.test(ua)){var type=ua.match(/NetType\/(\S*)/);network_state=type[1]}else document.addEventListener("WeixinJSBridgeReady",function(){WeixinJSBridge.invoke("getNetworkType",{},function(e){network_state=e.err_msg})});else if(con){var network=con.type;network="wifi"===network?"WIFI":"cellular"===network||con.effectiveType?"4G":"WIFI"==network?"WIFI":"4G",network_state=network}var domList=$("#feedlist_id"),tipBox=domList.find("li.tip_box"),getNewNotice=$(".msg-tooltip"),getNewNoticeMsg=getNewNotice.find("div.update_counts"),noFocusBox=null,newNotice=$("div.feed-fix-box");getMore($(".feed_loading"),"new",!0,loadFirst);var adNum=0,mswiper=function(e){function t(){a._htmlBulider(i.data),i.isPagination&&a._dotteBulider(),a._bindFun(o.screen[0],"touchstart",a._fnStart),a._bindFun(o.screen[0],"touchmove",a._fnMove),a._bindFun(o.screen[0],"touchend",a._fnEnd),o.autoPlayTimer=setInterval(function(){a._swiping(-1)},i.autoPlayTime)}var n=this,i={sWindow:$("div.carousel"),data:[],swipeSpeed:.4,isPagination:!0,isAutoPlay:!1,autoPlayTime:5e3};"object"==typeof e&&$.extend(i,e);var o={screen:null,dotte:null,moveSize:7.5,curIdx:0,pageCount:0,curMove:-7.5,autoPlayTimer:null,movelimit:0,fixTimer:null},a={_htmlBulider:function(e){o.pageCount=e.length,o.movelimit=(e.length+1)*o.moveSize,o.screen=$("<div class='carousel-box clearfix csdn-tracking-statistics' data-mod='popu_465' data-dsm='post'></div>"),o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+-o.moveSize+"rem)",i.sWindow.append(o.screen),o.screen.css({width:(o.pageCount+2)*o.moveSize+"rem"});for(var t,n,r=0;r<o.pageCount;r++){var s=a._htmlItemBulider(e[r],r);0===r&&(t=s.clone()),r===o.pageCount-1&&(n=s.clone()),o.screen.append(s)}o.screen.prepend(n),o.screen.append(t)},_dotteBulider:function(){var e=$('<div class="carousel-dotte-box"></div>');o.dotte=$("<ol class='clearfix'></ol>"),i.sWindow.append(e),e.append(o.dotte);for(var t=0;t<o.pageCount;t++)o.dotte.append("<li"+(0===t?" class='active'":"")+"></li>")},_htmlItemBulider:function(e,t){var n='<div class="carousel-item" data-swiper-slide-idx="'+t+'">                    <a href="'+e.url+'" target="_blank">                        <img src="'+e.imgUrl+'">                        <div class="carousel-caption">'+e.title+"</div>                    </a>                </div>";return $(n)},_swiping:function(e){o.screen.css("transition-duration",i.swipeSpeed+"s"),o.curMove+=e*o.moveSize,o.curIdx=Math.abs(o.curMove)/o.moveSize,o.curIdx=o.curIdx>o.pageCount?1:o.curIdx,o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+o.curMove+"rem)",o.dotte.find("li").removeClass("active").eq(o.curIdx-1).addClass("active"),o.curMove===-o.movelimit&&setTimeout(function(){o.screen.css("transition-duration","0s"),o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+-o.moveSize+"rem)",o.curMove=-o.moveSize},800*i.swipeSpeed),0===o.curMove&&(o.fixTimer=setTimeout(function(){o.screen.css("transition-duration","0s"),o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+-(o.movelimit-o.moveSize)+"rem)",o.curMove=-(o.curMove-o.moveSize+o.movelimit)},800*i.swipeSpeed))},_fnStart:function(e){o.curMove===-o.movelimit+-o.moveSize&&(o.screen.css("transition-duration","0s"),o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+-o.moveSize+"rem)",o.curMove=-o.moveSize),0===o.curMove&&(clearTimeout(o.fixTimer),o.screen.css("transition-duration","0s"),o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+-(o.movelimit-o.moveSize)+"rem)",o.curMove=-o.movelimit+o.moveSize),clearInterval(o.autoPlayTimer),o.screen.css("transition-duration","0s"),e=e.changedTouches[0],iStartTouchX=e.pageX},_fnMove:function(e){e.preventDefault(),e=e.changedTouches[0],iDis=e.pageX-iStartTouchX,iX=o.curMove+a._pxTorem(iDis),o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+iX+"rem)"},_fnEnd:function(){Math.abs(iX%o.moveSize)>parseFloat(o.moveSize/5)?a._swiping(iDis>0?1:-1):(o.screen.css("transition-duration",i.swipeSpeed+"s"),o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+o.curMove+"rem)"),o.autoPlayTimer=setInterval(function(){a._swiping(-1)},i.autoPlayTime)},_bindFun:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,function(){n.call(e)})},_pxTorem:function(e){var t=parseFloat($("html").css("font-size").replace("px",""));return parseFloat(e/t)}};return t(),n.sBox=i.sWindow,n.hide=function(){n.sBox.hide(),clearInterval(o.autoPlayTimer)},n.show=function(){clearInterval(o.autoPlayTimer),o.curIdx=0,o.dotte.find("li").removeClass("active").eq(o.curIdx).addClass("active"),o.screen[0].style.WebkitTransform=o.screen[0].style.transform="translateX("+-o.moveSize+"rem)",o.curMove=-o.moveSize,o.autoPlayTimer=setInterval(function(){a._swiping(-1)},i.autoPlayTime),n.sBox.show()},n};!function(e){var t={},n={};n.attachEvent=function(t,n,i){if("addEventListener"in e)return t.addEventListener(n,i,!1)},n.fireFakeEvent=function(e,t){if(document.createEvent)return e.target.dispatchEvent(n.createEvent(t))},n.createEvent=function(t){if(document.createEvent){var n=e.document.createEvent("HTMLEvents");return n.initEvent(t,!0,!0),n.eventName=t,n}},n.getRealEvent=function(e){return e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length?e.originalEvent.touches[0]:e.touches&&e.touches.length?e.touches[0]:e};var i=[{test:("propertyIsEnumerable"in e||"hasOwnProperty"in document)&&(e.propertyIsEnumerable("ontouchstart")||document.hasOwnProperty("ontouchstart")||e.hasOwnProperty("ontouchstart")),events:{start:"touchstart",move:"touchmove",end:"touchend"}},{test:e.navigator.msPointerEnabled,events:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},{test:e.navigator.pointerEnabled,events:{start:"pointerdown",move:"pointermove",end:"pointerup"}}];t.options={eventName:"tap",fingerMaxOffset:11};var o,a,r,s,c={};o=function(e){return n.attachEvent(document.documentElement,s[e],r[e])},r={start:function(e){e=n.getRealEvent(e),c.start=[e.pageX,e.pageY],c.offset=[0,0]},move:function(e){return!(!c.start&&!c.move)&&(e=n.getRealEvent(e),c.move=[e.pageX,e.pageY],c.offset=[Math.abs(c.move[0]-c.start[0]),Math.abs(c.move[1]-c.start[1])],void 0)},end:function(i){if(i=n.getRealEvent(i),c.offset&&i.preventDefault&&c.offset[0]<t.options.fingerMaxOffset&&c.offset[1]<t.options.fingerMaxOffset&&!n.fireFakeEvent(i,t.options.eventName)){if(e.navigator.msPointerEnabled||e.navigator.pointerEnabled){var o=function(e){e.preventDefault(),i.target.removeEventListener("click",o)};i.target.addEventListener("click",o,!1)}i.preventDefault()}c={}},click:function(e){if(!n.fireFakeEvent(e,t.options.eventName))return e.preventDefault()}},a=function(){for(var e=0;e<i.length;e++)if(i[e].test){s=i[e].events,o("start"),o("move"),o("end");break}return n.attachEvent(document.documentElement,"click",r.click)},n.attachEvent(e,"load",a),"function"==typeof define&&define.amd?define(function(){return a(),t}):e.Tap=t}(window),window.not_loading=!0,window.not_scroll=!1;var myswiper=null,newNotice=$("div.feed-fix-box"),tipBox=domList.find("li.tip_box"),bgTime=window.shownOffset.toString(),navList=$("nav").find("a.btn-nav");bgTime=bgTime.substring(0,bgTime.length-3),bgTime=(new Date).getTime()-bgTime,bgTime=parseInt(bgTime/6e4);var myReadTimer=new readTimer(bgTime);swipershow(),activeNav(),$("a.btn-nav").on("tap",function(e){e.preventDefault(),changeNav($(this))}),newNotice.find("button.btn-close-fixbar").bind("tap",function(e){e.preventDefault(),noticeHide()}),$("a.txt-refrash-new").bind("click",function(e){e.preventDefault(),refresh()});var newNoticeTop=domList.offset().top+newNotice.height();$(document).scroll(function(){var e=1!==$("div.no-focus-box").length;if(e){var t=$(this).scrollTop();t>=newNoticeTop?newNotice.removeClass("fixing").addClass("fixing"):newNotice.removeClass("fixing")}}),tipBox.bind("click",function(e){e.preventDefault(),refresh()}),$(window).scroll(function(){var e=1!==$("div.no-focus-box").length;if(e){var t=$(this).scrollTop(),n=$(document).height(),i=$(this).height();t+i>=n&&window.not_loading&&window.not_scroll&&(window.not_scroll=!1,getMore($(".feed_loading"),"more",!1,loadMore))}});var unlikeBox=$("div.unlike-opt-box");$("a.btn-cancle").bind("click",function(e){e.preventDefault(),unlikeBox.hide()}),$("body").on("click","button.btn-focus",function(){$(this).prop("disabled",!0),guanzhu($(this))});